{
  "nbformat": 4,
  "nbformat_minor": 4,
  "metadata": {
    "accelerator": "GPU",
    "colab": {
      "name": "Копия блокнота \"Data_Explorer_NeMo_golos.ipynb\"",
      "provenance": [],
      "collapsed_sections": []
    },
    "kernelspec": {
      "display_name": "Python 3",
      "language": "python",
      "name": "python3"
    },
    "language_info": {
      "codemirror_mode": {
        "name": "ipython",
        "version": 3
      },
      "file_extension": ".py",
      "mimetype": "text/x-python",
      "name": "python",
      "nbconvert_exporter": "python",
      "pygments_lexer": "ipython3",
      "version": "3.7.10"
    },
    "pycharm": {
      "stem_cell": {
        "cell_type": "raw",
        "source": [],
        "metadata": {
          "collapsed": false
        }
      }
    },
      "widgets": {
          "application/vnd.jupyter.widget-state+json": {
              "84ab5c2121b64d8cbae57e2273b01e67": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "HBoxModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "HBoxView",
                      "_dom_classes": [],
                      "_model_name": "HBoxModel",
                      "_view_module": "@jupyter-widgets/controls",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.5.0",
                      "box_style": "",
                      "layout": "IPY_MODEL_d5f45845091c4710a90d357e8e5f548e",
                      "_model_module": "@jupyter-widgets/controls",
                      "children": [
                          "IPY_MODEL_a7adb739ca1e49e483b09d53959c6f64",
                          "IPY_MODEL_f026cdd1eee947c2bf39882bcd97ac41",
                          "IPY_MODEL_645d5189cd9c4951a645d5e851777b72"
                      ]
                  }
              },
              "d5f45845091c4710a90d357e8e5f548e": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": "row wrap",
                      "width": "100%",
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": null,
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": "inline-flex",
                      "left": null
                  }
              },
              "a7adb739ca1e49e483b09d53959c6f64": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "HTMLModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "HTMLView",
                      "style": "IPY_MODEL_63ea41fc3372498f80d45c93bd585465",
                      "_dom_classes": [],
                      "description": "",
                      "_model_name": "HTMLModel",
                      "placeholder": "​",
                      "_view_module": "@jupyter-widgets/controls",
                      "_model_module_version": "1.5.0",
                      "value": "Validation sanity check:   0%",
                      "_view_count": null,
                      "_view_module_version": "1.5.0",
                      "description_tooltip": null,
                      "_model_module": "@jupyter-widgets/controls",
                      "layout": "IPY_MODEL_60392cf58b88485ebcd00cdfa6d81efb"
                  }
              },
              "f026cdd1eee947c2bf39882bcd97ac41": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "FloatProgressModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "ProgressView",
                      "style": "IPY_MODEL_66ed539d7a8146eea926f2a58b585450",
                      "_dom_classes": [],
                      "description": "",
                      "_model_name": "FloatProgressModel",
                      "bar_style": "danger",
                      "max": 2,
                      "_view_module": "@jupyter-widgets/controls",
                      "_model_module_version": "1.5.0",
                      "value": 0,
                      "_view_count": null,
                      "_view_module_version": "1.5.0",
                      "orientation": "horizontal",
                      "min": 0,
                      "description_tooltip": null,
                      "_model_module": "@jupyter-widgets/controls",
                      "layout": "IPY_MODEL_428011d8dbca46ffb283bd8853154d58"
                  }
              },
              "645d5189cd9c4951a645d5e851777b72": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "HTMLModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "HTMLView",
                      "style": "IPY_MODEL_9e04ab4cfb6543d980b36e85fb43d56c",
                      "_dom_classes": [],
                      "description": "",
                      "_model_name": "HTMLModel",
                      "placeholder": "​",
                      "_view_module": "@jupyter-widgets/controls",
                      "_model_module_version": "1.5.0",
                      "value": " 0/2 [00:00&lt;?, ?it/s]",
                      "_view_count": null,
                      "_view_module_version": "1.5.0",
                      "description_tooltip": null,
                      "_model_module": "@jupyter-widgets/controls",
                      "layout": "IPY_MODEL_57c34e976a0649cd883fece02509d97a"
                  }
              },
              "63ea41fc3372498f80d45c93bd585465": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "DescriptionStyleModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "StyleView",
                      "_model_name": "DescriptionStyleModel",
                      "description_width": "",
                      "_view_module": "@jupyter-widgets/base",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.2.0",
                      "_model_module": "@jupyter-widgets/controls"
                  }
              },
              "60392cf58b88485ebcd00cdfa6d81efb": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": null,
                      "width": null,
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": null,
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": null,
                      "left": null
                  }
              },
              "66ed539d7a8146eea926f2a58b585450": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "ProgressStyleModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "StyleView",
                      "_model_name": "ProgressStyleModel",
                      "description_width": "",
                      "_view_module": "@jupyter-widgets/base",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.2.0",
                      "bar_color": null,
                      "_model_module": "@jupyter-widgets/controls"
                  }
              },
              "428011d8dbca46ffb283bd8853154d58": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": null,
                      "width": null,
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": "2",
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": null,
                      "left": null
                  }
              },
              "9e04ab4cfb6543d980b36e85fb43d56c": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "DescriptionStyleModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "StyleView",
                      "_model_name": "DescriptionStyleModel",
                      "description_width": "",
                      "_view_module": "@jupyter-widgets/base",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.2.0",
                      "_model_module": "@jupyter-widgets/controls"
                  }
              },
              "57c34e976a0649cd883fece02509d97a": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": null,
                      "width": null,
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": null,
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": null,
                      "left": null
                  }
              },
              "314d9097b51346eb82769412691f80ca": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "HBoxModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "HBoxView",
                      "_dom_classes": [],
                      "_model_name": "HBoxModel",
                      "_view_module": "@jupyter-widgets/controls",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.5.0",
                      "box_style": "",
                      "layout": "IPY_MODEL_33bf93d58a2d4f1a9bad924e61762b59",
                      "_model_module": "@jupyter-widgets/controls",
                      "children": [
                          "IPY_MODEL_05c4ab35cae64f99a20effc2c2056624",
                          "IPY_MODEL_c7f80c5802f3430c827a737ca3dcdead",
                          "IPY_MODEL_5b8fafcc2b6e48148d1365c43f56c0e9"
                      ]
                  }
              },
              "33bf93d58a2d4f1a9bad924e61762b59": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": "row wrap",
                      "width": "100%",
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": null,
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": "inline-flex",
                      "left": null
                  }
              },
              "05c4ab35cae64f99a20effc2c2056624": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "HTMLModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "HTMLView",
                      "style": "IPY_MODEL_299a8120286544969b7b36b91933f524",
                      "_dom_classes": [],
                      "description": "",
                      "_model_name": "HTMLModel",
                      "placeholder": "​",
                      "_view_module": "@jupyter-widgets/controls",
                      "_model_module_version": "1.5.0",
                      "value": "Epoch 4: 100%",
                      "_view_count": null,
                      "_view_module_version": "1.5.0",
                      "description_tooltip": null,
                      "_model_module": "@jupyter-widgets/controls",
                      "layout": "IPY_MODEL_bc161a7d8b4b435cbc72436e921abc40"
                  }
              },
              "c7f80c5802f3430c827a737ca3dcdead": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "FloatProgressModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "ProgressView",
                      "style": "IPY_MODEL_2586b3014de845488a69a5758b3353d1",
                      "_dom_classes": [],
                      "description": "",
                      "_model_name": "FloatProgressModel",
                      "bar_style": "success",
                      "max": 185,
                      "_view_module": "@jupyter-widgets/controls",
                      "_model_module_version": "1.5.0",
                      "value": 185,
                      "_view_count": null,
                      "_view_module_version": "1.5.0",
                      "orientation": "horizontal",
                      "min": 0,
                      "description_tooltip": null,
                      "_model_module": "@jupyter-widgets/controls",
                      "layout": "IPY_MODEL_dd43e6765f8840e5be3f5999e73dc4c1"
                  }
              },
              "5b8fafcc2b6e48148d1365c43f56c0e9": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "HTMLModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "HTMLView",
                      "style": "IPY_MODEL_9d7e7281a9d548a59d14301cca068725",
                      "_dom_classes": [],
                      "description": "",
                      "_model_name": "HTMLModel",
                      "placeholder": "​",
                      "_view_module": "@jupyter-widgets/controls",
                      "_model_module_version": "1.5.0",
                      "value": " 185/185 [01:00&lt;00:00,  3.07it/s, loss=807, v_num=5]",
                      "_view_count": null,
                      "_view_module_version": "1.5.0",
                      "description_tooltip": null,
                      "_model_module": "@jupyter-widgets/controls",
                      "layout": "IPY_MODEL_aecfd4db10b447cbabc9015a3069b82c"
                  }
              },
              "299a8120286544969b7b36b91933f524": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "DescriptionStyleModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "StyleView",
                      "_model_name": "DescriptionStyleModel",
                      "description_width": "",
                      "_view_module": "@jupyter-widgets/base",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.2.0",
                      "_model_module": "@jupyter-widgets/controls"
                  }
              },
              "bc161a7d8b4b435cbc72436e921abc40": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": null,
                      "width": null,
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": null,
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": null,
                      "left": null
                  }
              },
              "2586b3014de845488a69a5758b3353d1": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "ProgressStyleModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "StyleView",
                      "_model_name": "ProgressStyleModel",
                      "description_width": "",
                      "_view_module": "@jupyter-widgets/base",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.2.0",
                      "bar_color": null,
                      "_model_module": "@jupyter-widgets/controls"
                  }
              },
              "dd43e6765f8840e5be3f5999e73dc4c1": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": null,
                      "width": null,
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": "2",
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": null,
                      "left": null
                  }
              },
              "9d7e7281a9d548a59d14301cca068725": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "DescriptionStyleModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "StyleView",
                      "_model_name": "DescriptionStyleModel",
                      "description_width": "",
                      "_view_module": "@jupyter-widgets/base",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.2.0",
                      "_model_module": "@jupyter-widgets/controls"
                  }
              },
              "aecfd4db10b447cbabc9015a3069b82c": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": null,
                      "width": null,
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": null,
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": null,
                      "left": null
                  }
              },
              "596884913ace448a8825462061813a4f": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "HBoxModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "HBoxView",
                      "_dom_classes": [],
                      "_model_name": "HBoxModel",
                      "_view_module": "@jupyter-widgets/controls",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.5.0",
                      "box_style": "",
                      "layout": "IPY_MODEL_fd6df388a9f04bbaa0c3217fad285655",
                      "_model_module": "@jupyter-widgets/controls",
                      "children": [
                          "IPY_MODEL_41a880413d4d4e57abea967ec4c1a692",
                          "IPY_MODEL_e6ccc13c896b4cb887e1cf2965e91304",
                          "IPY_MODEL_9a5d38c31f0d4207bdef5b70abc5ec2c"
                      ]
                  }
              },
              "fd6df388a9f04bbaa0c3217fad285655": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": "row wrap",
                      "width": "100%",
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": null,
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": "inline-flex",
                      "left": null
                  }
              },
              "d14acf4cbde346fc911955146a8eff8d": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "ProgressStyleModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "StyleView",
                      "_model_name": "ProgressStyleModel",
                      "description_width": "",
                      "_view_module": "@jupyter-widgets/base",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.2.0",
                      "bar_color": null,
                      "_model_module": "@jupyter-widgets/controls"
                  }
              },
              "2f9cd95f3d7a48869c523e4b8428ded6": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": null,
                      "width": null,
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": "2",
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": null,
                      "left": null
                  }
              },
              "174a9cac73db478cbe21d4c323886d01": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "DescriptionStyleModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "StyleView",
                      "_model_name": "DescriptionStyleModel",
                      "description_width": "",
                      "_view_module": "@jupyter-widgets/base",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.2.0",
                      "_model_module": "@jupyter-widgets/controls"
                  }
              },
              "f588c5b3bb4643308c32864a0d9ac63d": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": null,
                      "width": null,
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": null,
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": null,
                      "left": null
                  }
              },
              "494499b103ba4acd981142e881e98bab": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "HBoxModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "HBoxView",
                      "_dom_classes": [],
                      "_model_name": "HBoxModel",
                      "_view_module": "@jupyter-widgets/controls",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.5.0",
                      "box_style": "",
                      "layout": "IPY_MODEL_df4925395daa4b19b2b1594da0c1359d",
                      "_model_module": "@jupyter-widgets/controls",
                      "children": [
                          "IPY_MODEL_811547e792e443578cc1c2aa7543e55e",
                          "IPY_MODEL_25c4dca83e284e0ea863665ee91cd1cc",
                          "IPY_MODEL_f9fdbed2720548eb9711f8f9ccb1e2f3"
                      ]
                  }
              },
              "df4925395daa4b19b2b1594da0c1359d": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": "row wrap",
                      "width": "100%",
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": null,
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": "inline-flex",
                      "left": null
                  }
              },
              "811547e792e443578cc1c2aa7543e55e": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "HTMLModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "HTMLView",
                      "style": "IPY_MODEL_481a9172e1f64a20b2ba30abd7756d99",
                      "_dom_classes": [],
                      "description": "",
                      "_model_name": "HTMLModel",
                      "placeholder": "​",
                      "_view_module": "@jupyter-widgets/controls",
                      "_model_module_version": "1.5.0",
                      "value": "Validating: 100%",
                      "_view_count": null,
                      "_view_module_version": "1.5.0",
                      "description_tooltip": null,
                      "_model_module": "@jupyter-widgets/controls",
                      "layout": "IPY_MODEL_cff634a919e848c8b1e0b6aca4794aa4"
                  }
              },
              "25c4dca83e284e0ea863665ee91cd1cc": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "FloatProgressModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "ProgressView",
                      "style": "IPY_MODEL_424f31585196492e95b54da3288efaa0",
                      "_dom_classes": [],
                      "description": "",
                      "_model_name": "FloatProgressModel",
                      "bar_style": "",
                      "max": 30,
                      "_view_module": "@jupyter-widgets/controls",
                      "_model_module_version": "1.5.0",
                      "value": 30,
                      "_view_count": null,
                      "_view_module_version": "1.5.0",
                      "orientation": "horizontal",
                      "min": 0,
                      "description_tooltip": null,
                      "_model_module": "@jupyter-widgets/controls",
                      "layout": "IPY_MODEL_7103c799acfc42649bb9185c023cc799"
                  }
              },
              "f9fdbed2720548eb9711f8f9ccb1e2f3": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "HTMLModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "HTMLView",
                      "style": "IPY_MODEL_396648494f8d4748a5006ef94c889136",
                      "_dom_classes": [],
                      "description": "",
                      "_model_name": "HTMLModel",
                      "placeholder": "​",
                      "_view_module": "@jupyter-widgets/controls",
                      "_model_module_version": "1.5.0",
                      "value": " 30/30 [00:03&lt;00:00,  8.08it/s]",
                      "_view_count": null,
                      "_view_module_version": "1.5.0",
                      "description_tooltip": null,
                      "_model_module": "@jupyter-widgets/controls",
                      "layout": "IPY_MODEL_2cb7743efe39499ba38d9462de6ffcea"
                  }
              },
              "481a9172e1f64a20b2ba30abd7756d99": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "DescriptionStyleModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "StyleView",
                      "_model_name": "DescriptionStyleModel",
                      "description_width": "",
                      "_view_module": "@jupyter-widgets/base",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.2.0",
                      "_model_module": "@jupyter-widgets/controls"
                  }
              },
              "cff634a919e848c8b1e0b6aca4794aa4": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": null,
                      "width": null,
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": null,
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": null,
                      "left": null
                  }
              },
              "424f31585196492e95b54da3288efaa0": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "ProgressStyleModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "StyleView",
                      "_model_name": "ProgressStyleModel",
                      "description_width": "",
                      "_view_module": "@jupyter-widgets/base",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.2.0",
                      "bar_color": null,
                      "_model_module": "@jupyter-widgets/controls"
                  }
              },
              "7103c799acfc42649bb9185c023cc799": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": null,
                      "width": null,
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": "2",
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": null,
                      "left": null
                  }
              },
              "396648494f8d4748a5006ef94c889136": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "DescriptionStyleModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "StyleView",
                      "_model_name": "DescriptionStyleModel",
                      "description_width": "",
                      "_view_module": "@jupyter-widgets/base",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.2.0",
                      "_model_module": "@jupyter-widgets/controls"
                  }
              },
              "2cb7743efe39499ba38d9462de6ffcea": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": null,
                      "width": null,
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": null,
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": null,
                      "left": null
                  }
              },
              "3d546d31a9ec4b569da2913c1eff2027": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "HBoxModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "HBoxView",
                      "_dom_classes": [],
                      "_model_name": "HBoxModel",
                      "_view_module": "@jupyter-widgets/controls",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.5.0",
                      "box_style": "",
                      "layout": "IPY_MODEL_658a73053b4d4f0e9d91489b2273ff0d",
                      "_model_module": "@jupyter-widgets/controls",
                      "children": [
                          "IPY_MODEL_4937e82555fa48a39ab909e5aec2c073",
                          "IPY_MODEL_f1212314108a423391c56778fe1faf1f",
                          "IPY_MODEL_36a59e521c664a37998d30ddd08ba212"
                      ]
                  }
              },
              "658a73053b4d4f0e9d91489b2273ff0d": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": "row wrap",
                      "width": "100%",
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": null,
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": "inline-flex",
                      "left": null
                  }
              },
              "4937e82555fa48a39ab909e5aec2c073": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "HTMLModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "HTMLView",
                      "style": "IPY_MODEL_bc4643481ba3449091dbb5bc6b5570bf",
                      "_dom_classes": [],
                      "description": "",
                      "_model_name": "HTMLModel",
                      "placeholder": "​",
                      "_view_module": "@jupyter-widgets/controls",
                      "_model_module_version": "1.5.0",
                      "value": "Validating: 100%",
                      "_view_count": null,
                      "_view_module_version": "1.5.0",
                      "description_tooltip": null,
                      "_model_module": "@jupyter-widgets/controls",
                      "layout": "IPY_MODEL_5a845a89ba3644719af7339edec5055f"
                  }
              },
              "f1212314108a423391c56778fe1faf1f": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "FloatProgressModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "ProgressView",
                      "style": "IPY_MODEL_8fced5fb01ef45c8b4142ca47cc288c9",
                      "_dom_classes": [],
                      "description": "",
                      "_model_name": "FloatProgressModel",
                      "bar_style": "",
                      "max": 30,
                      "_view_module": "@jupyter-widgets/controls",
                      "_model_module_version": "1.5.0",
                      "value": 30,
                      "_view_count": null,
                      "_view_module_version": "1.5.0",
                      "orientation": "horizontal",
                      "min": 0,
                      "description_tooltip": null,
                      "_model_module": "@jupyter-widgets/controls",
                      "layout": "IPY_MODEL_71ab2d40a4b44a6e9dab85e729a32adc"
                  }
              },
              "36a59e521c664a37998d30ddd08ba212": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "HTMLModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "HTMLView",
                      "style": "IPY_MODEL_6604a003a1194881950be17362179d67",
                      "_dom_classes": [],
                      "description": "",
                      "_model_name": "HTMLModel",
                      "placeholder": "​",
                      "_view_module": "@jupyter-widgets/controls",
                      "_model_module_version": "1.5.0",
                      "value": " 30/30 [00:03&lt;00:00,  8.09it/s]",
                      "_view_count": null,
                      "_view_module_version": "1.5.0",
                      "description_tooltip": null,
                      "_model_module": "@jupyter-widgets/controls",
                      "layout": "IPY_MODEL_a4b5b8b0d8cd475aa736217131bce1f3"
                  }
              },
              "bc4643481ba3449091dbb5bc6b5570bf": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "DescriptionStyleModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "StyleView",
                      "_model_name": "DescriptionStyleModel",
                      "description_width": "",
                      "_view_module": "@jupyter-widgets/base",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.2.0",
                      "_model_module": "@jupyter-widgets/controls"
                  }
              },
              "5a845a89ba3644719af7339edec5055f": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": null,
                      "width": null,
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": null,
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": null,
                      "left": null
                  }
              },
              "8fced5fb01ef45c8b4142ca47cc288c9": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "ProgressStyleModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "StyleView",
                      "_model_name": "ProgressStyleModel",
                      "description_width": "",
                      "_view_module": "@jupyter-widgets/base",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.2.0",
                      "bar_color": null,
                      "_model_module": "@jupyter-widgets/controls"
                  }
              },
              "71ab2d40a4b44a6e9dab85e729a32adc": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": null,
                      "width": null,
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": "2",
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": null,
                      "left": null
                  }
              },
              "6604a003a1194881950be17362179d67": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "DescriptionStyleModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "StyleView",
                      "_model_name": "DescriptionStyleModel",
                      "description_width": "",
                      "_view_module": "@jupyter-widgets/base",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.2.0",
                      "_model_module": "@jupyter-widgets/controls"
                  }
              },
              "a4b5b8b0d8cd475aa736217131bce1f3": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": null,
                      "width": null,
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": null,
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": null,
                      "left": null
                  }
              },
              "40dbcfe887d143b0983be8e98d21d078": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "HBoxModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "HBoxView",
                      "_dom_classes": [],
                      "_model_name": "HBoxModel",
                      "_view_module": "@jupyter-widgets/controls",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.5.0",
                      "box_style": "",
                      "layout": "IPY_MODEL_9d09d0dd4f26439982f29ab28e797b1f",
                      "_model_module": "@jupyter-widgets/controls",
                      "children": [
                          "IPY_MODEL_ee9ab678e78b4be6bd4bcbfb905fe0b6",
                          "IPY_MODEL_465396f3c72d4ae1a23b8b38cfe701c1",
                          "IPY_MODEL_c6ffbd06c66e40ca98bea00609a4a4f6"
                      ]
                  }
              },
              "9d09d0dd4f26439982f29ab28e797b1f": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": "row wrap",
                      "width": "100%",
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": null,
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": "inline-flex",
                      "left": null
                  }
              },
              "ee9ab678e78b4be6bd4bcbfb905fe0b6": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "HTMLModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "HTMLView",
                      "style": "IPY_MODEL_5292fad7438b4ef2a075eb4f4ed77a99",
                      "_dom_classes": [],
                      "description": "",
                      "_model_name": "HTMLModel",
                      "placeholder": "​",
                      "_view_module": "@jupyter-widgets/controls",
                      "_model_module_version": "1.5.0",
                      "value": "Validating: 100%",
                      "_view_count": null,
                      "_view_module_version": "1.5.0",
                      "description_tooltip": null,
                      "_model_module": "@jupyter-widgets/controls",
                      "layout": "IPY_MODEL_0f4a1cda107548f1828b628ec7f2b922"
                  }
              },
              "465396f3c72d4ae1a23b8b38cfe701c1": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "FloatProgressModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "ProgressView",
                      "style": "IPY_MODEL_47f4bd0be1394133aa71116310daab10",
                      "_dom_classes": [],
                      "description": "",
                      "_model_name": "FloatProgressModel",
                      "bar_style": "",
                      "max": 30,
                      "_view_module": "@jupyter-widgets/controls",
                      "_model_module_version": "1.5.0",
                      "value": 30,
                      "_view_count": null,
                      "_view_module_version": "1.5.0",
                      "orientation": "horizontal",
                      "min": 0,
                      "description_tooltip": null,
                      "_model_module": "@jupyter-widgets/controls",
                      "layout": "IPY_MODEL_7fef4bdb898d4062990b2ec28c316ef7"
                  }
              },
              "c6ffbd06c66e40ca98bea00609a4a4f6": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "HTMLModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "HTMLView",
                      "style": "IPY_MODEL_b9ac3c1cfa6e4a50a73d876ac358fa6f",
                      "_dom_classes": [],
                      "description": "",
                      "_model_name": "HTMLModel",
                      "placeholder": "​",
                      "_view_module": "@jupyter-widgets/controls",
                      "_model_module_version": "1.5.0",
                      "value": " 30/30 [00:03&lt;00:00,  8.06it/s]",
                      "_view_count": null,
                      "_view_module_version": "1.5.0",
                      "description_tooltip": null,
                      "_model_module": "@jupyter-widgets/controls",
                      "layout": "IPY_MODEL_b9e8e905427549d0a87840f1152320fe"
                  }
              },
              "5292fad7438b4ef2a075eb4f4ed77a99": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "DescriptionStyleModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "StyleView",
                      "_model_name": "DescriptionStyleModel",
                      "description_width": "",
                      "_view_module": "@jupyter-widgets/base",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.2.0",
                      "_model_module": "@jupyter-widgets/controls"
                  }
              },
              "0f4a1cda107548f1828b628ec7f2b922": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": null,
                      "width": null,
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": null,
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": null,
                      "left": null
                  }
              },
              "47f4bd0be1394133aa71116310daab10": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "ProgressStyleModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "StyleView",
                      "_model_name": "ProgressStyleModel",
                      "description_width": "",
                      "_view_module": "@jupyter-widgets/base",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.2.0",
                      "bar_color": null,
                      "_model_module": "@jupyter-widgets/controls"
                  }
              },
              "7fef4bdb898d4062990b2ec28c316ef7": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": null,
                      "width": null,
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": "2",
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": null,
                      "left": null
                  }
              },
              "b9ac3c1cfa6e4a50a73d876ac358fa6f": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "DescriptionStyleModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "StyleView",
                      "_model_name": "DescriptionStyleModel",
                      "description_width": "",
                      "_view_module": "@jupyter-widgets/base",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.2.0",
                      "_model_module": "@jupyter-widgets/controls"
                  }
              },
              "b9e8e905427549d0a87840f1152320fe": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": null,
                      "width": null,
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": null,
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": null,
                      "left": null
                  }
              },
              "2461834afe024e6c803aa059316f5ad8": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "HBoxModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "HBoxView",
                      "_dom_classes": [],
                      "_model_name": "HBoxModel",
                      "_view_module": "@jupyter-widgets/controls",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.5.0",
                      "box_style": "",
                      "layout": "IPY_MODEL_b3a6dfef4a544ed9be045214ef83bf9b",
                      "_model_module": "@jupyter-widgets/controls",
                      "children": [
                          "IPY_MODEL_3bb0df660e4449f0a46259f0c762a016",
                          "IPY_MODEL_21532804ac5649feaf799496f7eebf9d",
                          "IPY_MODEL_648f9c1b82d6419fae79c4d7c7da8628"
                      ]
                  }
              },
              "b3a6dfef4a544ed9be045214ef83bf9b": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": "row wrap",
                      "width": "100%",
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": null,
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": "inline-flex",
                      "left": null
                  }
              },
              "ff93a095a9c844029b850a8d98bddc32": {
                  "model_module": "@jupyter-widgets/controls",
                  "model_name": "ProgressStyleModel",
                  "model_module_version": "1.5.0",
                  "state": {
                      "_view_name": "StyleView",
                      "_model_name": "ProgressStyleModel",
                      "description_width": "",
                      "_view_module": "@jupyter-widgets/base",
                      "_model_module_version": "1.5.0",
                      "_view_count": null,
                      "_view_module_version": "1.2.0",
                      "bar_color": null,
                      "_model_module": "@jupyter-widgets/controls"
                  }
              },
              "a10a8f4b68b34f5b8d35df7a2f01e829": {
                  "model_module": "@jupyter-widgets/base",
                  "model_name": "LayoutModel",
                  "model_module_version": "1.2.0",
                  "state": {
                      "_view_name": "LayoutView",
                      "grid_template_rows": null,
                      "right": null,
                      "justify_content": null,
                      "_view_module": "@jupyter-widgets/base",
                      "overflow": null,
                      "_model_module_version": "1.2.0",
                      "_view_count": null,
                      "flex_flow": null,
                      "width": null,
                      "min_width": null,
                      "border": null,
                      "align_items": null,
                      "bottom": null,
                      "_model_module": "@jupyter-widgets/base",
                      "top": null,
                      "grid_column": null,
                      "overflow_y": null,
                      "overflow_x": null,
                      "grid_auto_flow": null,
                      "grid_area": null,
                      "grid_template_columns": null,
                      "flex": "2",
                      "_model_name": "LayoutModel",
                      "justify_items": null,
                      "grid_row": null,
                      "max_height": null,
                      "align_content": null,
                      "visibility": null,
                      "align_self": null,
                      "height": null,
                      "min_height": null,
                      "padding": null,
                      "grid_auto_rows": null,
                      "grid_gap": null,
                      "max_width": null,
                      "order": null,
                      "_view_module_version": "1.2.0",
                      "grid_template_areas": null,
                      "object_position": null,
                      "object_fit": null,
                      "grid_auto_columns": null,
                      "margin": null,
                      "display": null,
                      "left": null
                  }
              }
          }
      }
},
    {
        "cell_type": "code",
        "metadata": {
            "colab": {
                "base_uri": "https://localhost:8080/"
            },
            "id": "1BS-fFS7L8Cg",
            "outputId": "3de72711-5b57-4652-a101-211b61778341"
        },
        "source": [
            "!pip install wandb"
        ],
        "execution_count": null,
        "outputs": [
            {
                "name": "stdout",
                "output_type": "stream",
                "text": [
                    "Requirement already satisfied: wandb in /usr/local/lib/python3.7/dist-packages (0.12.7)\n",
                    "Requirement already satisfied: yaspin>=1.0.0 in /usr/local/lib/python3.7/dist-packages (from wandb) (2.1.0)\n",
                    "Requirement already satisfied: six>=1.13.0 in /usr/local/lib/python3.7/dist-packages (from wandb) (1.15.0)\n",
                    "Requirement already satisfied: GitPython>=1.0.0 in /usr/local/lib/python3.7/dist-packages (from wandb) (3.1.24)\n",
                    "Requirement already satisfied: shortuuid>=0.5.0 in /usr/local/lib/python3.7/dist-packages (from wandb) (1.0.8)\n",
                    "Requirement already satisfied: docker-pycreds>=0.4.0 in /usr/local/lib/python3.7/dist-packages (from wandb) (0.4.0)\n",
                    "Requirement already satisfied: PyYAML in /usr/local/lib/python3.7/dist-packages (from wandb) (6.0)\n",
                    "Requirement already satisfied: requests<3,>=2.0.0 in /usr/local/lib/python3.7/dist-packages (from wandb) (2.23.0)\n",
                    "Requirement already satisfied: Click!=8.0.0,>=7.0 in /usr/local/lib/python3.7/dist-packages (from wandb) (7.1.2)\n",
                    "Requirement already satisfied: configparser>=3.8.1 in /usr/local/lib/python3.7/dist-packages (from wandb) (5.1.0)\n",
                    "Requirement already satisfied: sentry-sdk>=1.0.0 in /usr/local/lib/python3.7/dist-packages (from wandb) (1.5.0)\n",
                    "Requirement already satisfied: promise<3,>=2.0 in /usr/local/lib/python3.7/dist-packages (from wandb) (2.3)\n",
                    "Requirement already satisfied: pathtools in /usr/local/lib/python3.7/dist-packages (from wandb) (0.1.2)\n",
                    "Requirement already satisfied: protobuf>=3.12.0 in /usr/local/lib/python3.7/dist-packages (from wandb) (3.17.3)\n",
                    "Requirement already satisfied: psutil>=5.0.0 in /usr/local/lib/python3.7/dist-packages (from wandb) (5.4.8)\n",
                    "Requirement already satisfied: python-dateutil>=2.6.1 in /usr/local/lib/python3.7/dist-packages (from wandb) (2.8.2)\n",
                    "Requirement already satisfied: subprocess32>=3.5.3 in /usr/local/lib/python3.7/dist-packages (from wandb) (3.5.4)\n",
                    "Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.7/dist-packages (from GitPython>=1.0.0->wandb) (3.10.0.2)\n",
                    "Requirement already satisfied: gitdb<5,>=4.0.1 in /usr/local/lib/python3.7/dist-packages (from GitPython>=1.0.0->wandb) (4.0.9)\n",
                    "Requirement already satisfied: smmap<6,>=3.0.1 in /usr/local/lib/python3.7/dist-packages (from gitdb<5,>=4.0.1->GitPython>=1.0.0->wandb) (5.0.0)\n",
                    "Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests<3,>=2.0.0->wandb) (2.10)\n",
                    "Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests<3,>=2.0.0->wandb) (3.0.4)\n",
                    "Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests<3,>=2.0.0->wandb) (1.25.11)\n",
                    "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests<3,>=2.0.0->wandb) (2021.10.8)\n",
                    "Requirement already satisfied: termcolor<2.0.0,>=1.1.0 in /usr/local/lib/python3.7/dist-packages (from yaspin>=1.0.0->wandb) (1.1.0)\n"
                ]
            }
        ]
    },
{
    "cell_type": "code",
    "metadata": {
        "colab": {
            "base_uri": "https://localhost:8080/"
        },
        "id": "w2fDfPegbYrk",
        "outputId": "4c8dce65-5de1-47fa-d015-cfbd54d0f279"
    },
    "source": [
        "!pip install torchaudio==0.9.1"
    ],
    "execution_count": null,
    "outputs": [
        {
            "name": "stdout",
            "output_type": "stream",
            "text": [
                "Requirement already satisfied: torchaudio==0.9.1 in /usr/local/lib/python3.7/dist-packages (0.9.1)\n",
                "Requirement already satisfied: torch==1.9.1 in /usr/local/lib/python3.7/dist-packages (from torchaudio==0.9.1) (1.9.1)\n",
                "Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from torch==1.9.1->torchaudio==0.9.1) (3.10.0.2)\n"
            ]
        }
    ]
},
{
    "cell_type": "code",
    "metadata": {
        "colab": {
            "background_save": true,
            "base_uri": "https://localhost:8080/"
        },
        "id": "lJz6FDU1lRzc",
        "outputId": "5c9dd920-3594-4de7-f37a-fdaf14e69356"
    },
    "source": [
        "\"\"\"\n",
        "You can run either this notebook locally (if you have all the dependencies and a GPU) or on Google Colab.\n",
        "\n",
        "Instructions for setting up Colab are as follows:\n",
        "1. Open a new Python 3 notebook.\n",
        "2. Import this notebook from GitHub (File -> Upload Notebook -> \"GITHUB\" tab -> copy/paste GitHub URL)\n",
        "3. Connect to an instance with a GPU (Runtime -> Change runtime type -> select \"GPU\" for hardware accelerator)\n",
        "4. Run this cell to set up dependencies.\n",
        "5. Restart the runtime (Runtime -> Restart Runtime) for any upgraded packages to take effect\n",
        "\"\"\"\n",
        "# If you're using Google Colab and not running locally, run this cell.\n",
        "\n",
        "## Install dependencies\n",
        "!pip install wget\n",
        "!apt-get install sox libsndfile1 ffmpeg\n",
        "!pip install unidecode\n",
        "\n",
        "\n",
        "## Install NeMo\n",
        "BRANCH = 'r1.4.0'\n",
        "!python -m pip install git+https://github.com/NVIDIA/NeMo.git@$BRANCH#egg=nemo_toolkit[all]\n",
        "\n",
        "## Grab the config we'll use in this example\n",
        "!mkdir configs\n",
        "!wget -P configs/ https://raw.githubusercontent.com/NVIDIA/NeMo/$BRANCH/examples/asr/conf/config.yaml\n",
        "!pip install matplotlib==3.1.3\n",
        "\"\"\"\n",
        "Remember to restart the runtime for the kernel to pick up any upgraded packages (e.g. matplotlib)!\n",
        "Alternatively, you can uncomment the exit() below to crash and restart the kernel, in the case\n",
        "that you want to use the \"Run All Cells\" (or similar) option.\n",
        "\"\"\"\n",
        "# exit()"
    ],
    "execution_count": null,
    "outputs": [
        {
            "name": "stdout",
            "output_type": "stream",
            "text": [
                "Requirement already satisfied: wget in /usr/local/lib/python3.7/dist-packages (3.2)\n",
                "Reading package lists... Done\n",
                "Building dependency tree       \n",
                "Reading state information... Done\n",
                "libsndfile1 is already the newest version (1.0.28-4ubuntu0.18.04.2).\n",
                "ffmpeg is already the newest version (7:3.4.8-0ubuntu0.2).\n",
                "sox is already the newest version (14.4.2-3ubuntu0.18.04.1).\n",
                "0 upgraded, 0 newly installed, 0 to remove and 37 not upgraded.\n",
                "Requirement already satisfied: unidecode in /usr/local/lib/python3.7/dist-packages (1.3.2)\n",
                "Collecting nemo_toolkit[all]\n",
                "  Cloning https://github.com/NVIDIA/NeMo.git (to revision r1.4.0) to /tmp/pip-install-xya3_kmv/nemo-toolkit_684fc69530af45cbb7778cc76d3c4486\n",
                "  Running command git clone -q https://github.com/NVIDIA/NeMo.git /tmp/pip-install-xya3_kmv/nemo-toolkit_684fc69530af45cbb7778cc76d3c4486\n",
                "  Running command git checkout -b r1.4.0 --track origin/r1.4.0\n",
                "  Switched to a new branch 'r1.4.0'\n",
                "  Branch 'r1.4.0' set up to track remote branch 'r1.4.0' from 'origin'.\n",
                "Requirement already satisfied: numpy>=1.18.2 in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (1.19.5)\n",
                "Requirement already satisfied: onnx>=1.7.0 in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (1.10.2)\n",
                "Requirement already satisfied: python-dateutil in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (2.8.2)\n",
                "Requirement already satisfied: torch<1.10,>1.7 in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (1.9.1)\n",
                "Requirement already satisfied: wrapt in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (1.13.3)\n",
                "Requirement already satisfied: ruamel.yaml in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (0.17.17)\n",
                "Requirement already satisfied: scikit-learn in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (1.0.1)\n",
                "Requirement already satisfied: sentencepiece<1.0.0 in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (0.1.96)\n",
                "Requirement already satisfied: tqdm>=4.41.0 in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (4.62.3)\n",
                "Requirement already satisfied: numba in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (0.51.2)\n",
                "Requirement already satisfied: wget in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (3.2)\n",
                "Requirement already satisfied: frozendict in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (2.1.1)\n",
                "Requirement already satisfied: unidecode in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (1.3.2)\n",
                "Requirement already satisfied: black==19.10b0 in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (19.10b0)\n",
                "Requirement already satisfied: isort[requirements]<5 in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (4.3.21)\n",
                "Requirement already satisfied: parameterized in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (0.8.1)\n",
                "Requirement already satisfied: pytest in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (3.6.4)\n",
                "Requirement already satisfied: pytest-runner in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (5.3.1)\n",
                "Requirement already satisfied: sphinx in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (4.3.1)\n",
                "Requirement already satisfied: sphinxcontrib-bibtex in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (2.4.1)\n",
                "Requirement already satisfied: wandb in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (0.12.7)\n",
                "Requirement already satisfied: inflect in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (2.1.0)\n",
                "Requirement already satisfied: regex in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (2019.12.20)\n",
                "Requirement already satisfied: matplotlib in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (3.1.3)\n",
                "Requirement already satisfied: pypinyin in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (0.44.0)\n",
                "Requirement already satisfied: attrdict in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (2.0.1)\n",
                "Requirement already satisfied: pystoi in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (0.3.3)\n",
                "Requirement already satisfied: pesq in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (0.0.3)\n",
                "Requirement already satisfied: g2p_en in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (2.1.0)\n",
                "Requirement already satisfied: pandas in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (1.1.5)\n",
                "Requirement already satisfied: pytorch-lightning<1.5,>=1.4.8 in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (1.4.9)\n",
                "Requirement already satisfied: torchmetrics>=0.4.1rc0 in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (0.6.0)\n",
                "Requirement already satisfied: transformers>=4.0.1 in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (4.12.5)\n",
                "Requirement already satisfied: webdataset<=0.1.62,>=0.1.48 in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (0.1.62)\n",
                "Requirement already satisfied: omegaconf>=2.1.0 in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (2.1.1)\n",
                "Requirement already satisfied: hydra-core>=1.1.0 in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (1.1.1)\n",
                "Requirement already satisfied: braceexpand in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (0.1.7)\n",
                "Requirement already satisfied: editdistance in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (0.5.3)\n",
                "Requirement already satisfied: kaldi-io in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (0.9.4)\n",
                "Requirement already satisfied: librosa in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (0.8.1)\n",
                "Requirement already satisfied: marshmallow in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (3.14.1)\n",
                "Requirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (21.3)\n",
                "Requirement already satisfied: soundfile in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (0.10.3.post1)\n",
                "Requirement already satisfied: sox in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (1.4.1)\n",
                "Requirement already satisfied: kaldi-python-io in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (1.2.2)\n",
                "Requirement already satisfied: kaldiio in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (2.17.2)\n",
                "Requirement already satisfied: scipy in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (1.4.1)\n",
                "Requirement already satisfied: pydub in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (0.25.1)\n",
                "Requirement already satisfied: pyannote.core in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (4.3)\n",
                "Requirement already satisfied: pyannote.metrics in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (3.1)\n",
                "Requirement already satisfied: torch-stft in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (0.1.4)\n",
                "Requirement already satisfied: ipywidgets in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (7.6.5)\n",
                "Requirement already satisfied: pillow in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (7.1.2)\n",
                "Requirement already satisfied: torchvision in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (0.10.1)\n",
                "Requirement already satisfied: boto3 in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (1.20.16)\n",
                "Requirement already satisfied: h5py in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (3.1.0)\n",
                "Collecting matplotlib>=3.3.2\n",
                "  Using cached matplotlib-3.5.0-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.whl (11.2 MB)\n",
                "Requirement already satisfied: youtokentome>=1.0.5 in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (1.0.6)\n",
                "Requirement already satisfied: rapidfuzz in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (1.8.3)\n",
                "Requirement already satisfied: gdown in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (3.6.4)\n",
                "Requirement already satisfied: megatron-lm==2.2.0 in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (2.2.0)\n",
                "Requirement already satisfied: sacrebleu[ja] in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (2.0.0)\n",
                "Requirement already satisfied: sacremoses>=0.0.43 in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (0.0.46)\n",
                "Collecting nltk==3.6.2\n",
                "  Using cached nltk-3.6.2-py3-none-any.whl (1.5 MB)\n",
                "Requirement already satisfied: wordninja==2.0.0 in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (2.0.0)\n",
                "Requirement already satisfied: fasttext in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (0.9.2)\n",
                "Requirement already satisfied: opencc in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (1.1.3)\n",
                "Requirement already satisfied: pangu in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (4.0.6.1)\n",
                "Requirement already satisfied: jieba in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (0.42.1)\n",
                "Requirement already satisfied: nltk in /usr/local/lib/python3.7/dist-packages (from nemo_toolkit[all]) (3.2.5)\n",
                "Requirement already satisfied: click>=6.5 in /usr/local/lib/python3.7/dist-packages (from black==19.10b0->nemo_toolkit[all]) (7.1.2)\n",
                "Requirement already satisfied: pathspec<1,>=0.6 in /usr/local/lib/python3.7/dist-packages (from black==19.10b0->nemo_toolkit[all]) (0.9.0)\n",
                "Requirement already satisfied: appdirs in /usr/local/lib/python3.7/dist-packages (from black==19.10b0->nemo_toolkit[all]) (1.4.4)\n",
                "Requirement already satisfied: attrs>=18.1.0 in /usr/local/lib/python3.7/dist-packages (from black==19.10b0->nemo_toolkit[all]) (21.2.0)\n",
                "Requirement already satisfied: toml>=0.9.4 in /usr/local/lib/python3.7/dist-packages (from black==19.10b0->nemo_toolkit[all]) (0.10.2)\n",
                "Requirement already satisfied: typed-ast>=1.4.0 in /usr/local/lib/python3.7/dist-packages (from black==19.10b0->nemo_toolkit[all]) (1.5.0)\n",
                "Requirement already satisfied: pybind11 in /usr/local/lib/python3.7/dist-packages (from megatron-lm==2.2.0->nemo_toolkit[all]) (2.8.1)\n",
                "Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from megatron-lm==2.2.0->nemo_toolkit[all]) (1.15.0)\n",
                "Requirement already satisfied: importlib-resources in /usr/local/lib/python3.7/dist-packages (from hydra-core>=1.1.0->nemo_toolkit[all]) (5.4.0)\n",
                "Requirement already satisfied: antlr4-python3-runtime==4.8 in /usr/local/lib/python3.7/dist-packages (from hydra-core>=1.1.0->nemo_toolkit[all]) (4.8)\n",
                "Requirement already satisfied: PyYAML>=5.1.0 in /usr/local/lib/python3.7/dist-packages (from omegaconf>=2.1.0->nemo_toolkit[all]) (6.0)\n",
                "Requirement already satisfied: pip-api in /usr/local/lib/python3.7/dist-packages (from isort[requirements]<5->nemo_toolkit[all]) (0.0.23)\n",
                "Requirement already satisfied: pipreqs in /usr/local/lib/python3.7/dist-packages (from isort[requirements]<5->nemo_toolkit[all]) (0.4.11)\n",
                "Requirement already satisfied: setuptools-scm>=4 in /usr/local/lib/python3.7/dist-packages (from matplotlib>=3.3.2->nemo_toolkit[all]) (6.3.2)\n",
                "Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.7/dist-packages (from matplotlib>=3.3.2->nemo_toolkit[all]) (4.28.2)\n",
                "Requirement already satisfied: pyparsing>=2.2.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib>=3.3.2->nemo_toolkit[all]) (3.0.6)\n",
                "Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib>=3.3.2->nemo_toolkit[all]) (0.11.0)\n",
                "Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib>=3.3.2->nemo_toolkit[all]) (1.3.2)\n",
                "Requirement already satisfied: typing-extensions>=3.6.2.1 in /usr/local/lib/python3.7/dist-packages (from onnx>=1.7.0->nemo_toolkit[all]) (3.10.0.2)\n",
                "Requirement already satisfied: protobuf in /usr/local/lib/python3.7/dist-packages (from onnx>=1.7.0->nemo_toolkit[all]) (3.17.3)\n",
                "Requirement already satisfied: future>=0.17.1 in /usr/local/lib/python3.7/dist-packages (from pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (0.18.2)\n",
                "Requirement already satisfied: tensorboard>=2.2.0 in /usr/local/lib/python3.7/dist-packages (from pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (2.7.0)\n",
                "Requirement already satisfied: fsspec[http]!=2021.06.0,>=2021.05.0 in /usr/local/lib/python3.7/dist-packages (from pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (2021.11.1)\n",
                "Requirement already satisfied: pyDeprecate==0.3.1 in /usr/local/lib/python3.7/dist-packages (from pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (0.3.1)\n",
                "Requirement already satisfied: aiohttp in /usr/local/lib/python3.7/dist-packages (from fsspec[http]!=2021.06.0,>=2021.05.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (3.8.1)\n",
                "Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from fsspec[http]!=2021.06.0,>=2021.05.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (2.23.0)\n",
                "Requirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from sacremoses>=0.0.43->nemo_toolkit[all]) (1.1.0)\n",
                "Requirement already satisfied: tomli>=1.0.0 in /usr/local/lib/python3.7/dist-packages (from setuptools-scm>=4->matplotlib>=3.3.2->nemo_toolkit[all]) (1.2.2)\n",
                "Requirement already satisfied: setuptools in /usr/local/lib/python3.7/dist-packages (from setuptools-scm>=4->matplotlib>=3.3.2->nemo_toolkit[all]) (57.4.0)\n",
                "Requirement already satisfied: grpcio>=1.24.3 in /usr/local/lib/python3.7/dist-packages (from tensorboard>=2.2.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (1.42.0)\n",
                "Requirement already satisfied: google-auth-oauthlib<0.5,>=0.4.1 in /usr/local/lib/python3.7/dist-packages (from tensorboard>=2.2.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (0.4.6)\n",
                "Requirement already satisfied: google-auth<3,>=1.6.3 in /usr/local/lib/python3.7/dist-packages (from tensorboard>=2.2.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (1.35.0)\n",
                "Requirement already satisfied: tensorboard-data-server<0.7.0,>=0.6.0 in /usr/local/lib/python3.7/dist-packages (from tensorboard>=2.2.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (0.6.1)\n",
                "Requirement already satisfied: absl-py>=0.4 in /usr/local/lib/python3.7/dist-packages (from tensorboard>=2.2.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (0.12.0)\n",
                "Requirement already satisfied: markdown>=2.6.8 in /usr/local/lib/python3.7/dist-packages (from tensorboard>=2.2.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (3.3.6)\n",
                "Requirement already satisfied: werkzeug>=0.11.15 in /usr/local/lib/python3.7/dist-packages (from tensorboard>=2.2.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (1.0.1)\n",
                "Requirement already satisfied: wheel>=0.26 in /usr/local/lib/python3.7/dist-packages (from tensorboard>=2.2.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (0.37.0)\n",
                "Requirement already satisfied: tensorboard-plugin-wit>=1.6.0 in /usr/local/lib/python3.7/dist-packages (from tensorboard>=2.2.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (1.8.0)\n",
                "Requirement already satisfied: rsa<5,>=3.1.4 in /usr/local/lib/python3.7/dist-packages (from google-auth<3,>=1.6.3->tensorboard>=2.2.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (4.8)\n",
                "Requirement already satisfied: cachetools<5.0,>=2.0.0 in /usr/local/lib/python3.7/dist-packages (from google-auth<3,>=1.6.3->tensorboard>=2.2.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (4.2.4)\n",
                "Requirement already satisfied: pyasn1-modules>=0.2.1 in /usr/local/lib/python3.7/dist-packages (from google-auth<3,>=1.6.3->tensorboard>=2.2.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (0.2.8)\n",
                "Requirement already satisfied: requests-oauthlib>=0.7.0 in /usr/local/lib/python3.7/dist-packages (from google-auth-oauthlib<0.5,>=0.4.1->tensorboard>=2.2.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (1.3.0)\n",
                "Requirement already satisfied: importlib-metadata>=4.4 in /usr/local/lib/python3.7/dist-packages (from markdown>=2.6.8->tensorboard>=2.2.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (4.8.2)\n",
                "Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata>=4.4->markdown>=2.6.8->tensorboard>=2.2.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (3.6.0)\n",
                "Requirement already satisfied: pyasn1<0.5.0,>=0.4.6 in /usr/local/lib/python3.7/dist-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard>=2.2.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (0.4.8)\n",
                "Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->fsspec[http]!=2021.06.0,>=2021.05.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (1.25.11)\n",
                "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->fsspec[http]!=2021.06.0,>=2021.05.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (2021.10.8)\n",
                "Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->fsspec[http]!=2021.06.0,>=2021.05.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (3.0.4)\n",
                "Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->fsspec[http]!=2021.06.0,>=2021.05.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (2.10)\n",
                "Requirement already satisfied: oauthlib>=3.0.0 in /usr/local/lib/python3.7/dist-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<0.5,>=0.4.1->tensorboard>=2.2.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (3.1.1)\n",
                "Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers>=4.0.1->nemo_toolkit[all]) (3.4.0)\n",
                "Requirement already satisfied: tokenizers<0.11,>=0.10.1 in /usr/local/lib/python3.7/dist-packages (from transformers>=4.0.1->nemo_toolkit[all]) (0.10.3)\n",
                "Requirement already satisfied: huggingface-hub<1.0,>=0.1.0 in /usr/local/lib/python3.7/dist-packages (from transformers>=4.0.1->nemo_toolkit[all]) (0.1.2)\n",
                "Requirement already satisfied: charset-normalizer<3.0,>=2.0 in /usr/local/lib/python3.7/dist-packages (from aiohttp->fsspec[http]!=2021.06.0,>=2021.05.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (2.0.8)\n",
                "Requirement already satisfied: asynctest==0.13.0 in /usr/local/lib/python3.7/dist-packages (from aiohttp->fsspec[http]!=2021.06.0,>=2021.05.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (0.13.0)\n",
                "Requirement already satisfied: async-timeout<5.0,>=4.0.0a3 in /usr/local/lib/python3.7/dist-packages (from aiohttp->fsspec[http]!=2021.06.0,>=2021.05.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (4.0.1)\n",
                "Requirement already satisfied: yarl<2.0,>=1.0 in /usr/local/lib/python3.7/dist-packages (from aiohttp->fsspec[http]!=2021.06.0,>=2021.05.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (1.7.2)\n",
                "Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.7/dist-packages (from aiohttp->fsspec[http]!=2021.06.0,>=2021.05.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (5.2.0)\n",
                "Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.7/dist-packages (from aiohttp->fsspec[http]!=2021.06.0,>=2021.05.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (1.2.0)\n",
                "Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.7/dist-packages (from aiohttp->fsspec[http]!=2021.06.0,>=2021.05.0->pytorch-lightning<1.5,>=1.4.8->nemo_toolkit[all]) (1.2.0)\n",
                "Requirement already satisfied: s3transfer<0.6.0,>=0.5.0 in /usr/local/lib/python3.7/dist-packages (from boto3->nemo_toolkit[all]) (0.5.0)\n",
                "Requirement already satisfied: jmespath<1.0.0,>=0.7.1 in /usr/local/lib/python3.7/dist-packages (from boto3->nemo_toolkit[all]) (0.10.0)\n",
                "Requirement already satisfied: botocore<1.24.0,>=1.23.16 in /usr/local/lib/python3.7/dist-packages (from boto3->nemo_toolkit[all]) (1.23.16)\n",
                "Requirement already satisfied: distance>=0.1.3 in /usr/local/lib/python3.7/dist-packages (from g2p_en->nemo_toolkit[all]) (0.1.3)\n",
                "Requirement already satisfied: cached-property in /usr/local/lib/python3.7/dist-packages (from h5py->nemo_toolkit[all]) (1.5.2)\n",
                "Requirement already satisfied: jupyterlab-widgets>=1.0.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets->nemo_toolkit[all]) (1.0.2)\n",
                "Requirement already satisfied: ipython-genutils~=0.2.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets->nemo_toolkit[all]) (0.2.0)\n",
                "Requirement already satisfied: widgetsnbextension~=3.5.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets->nemo_toolkit[all]) (3.5.2)\n",
                "Requirement already satisfied: traitlets>=4.3.1 in /usr/local/lib/python3.7/dist-packages (from ipywidgets->nemo_toolkit[all]) (5.1.1)\n",
                "Requirement already satisfied: ipykernel>=4.5.1 in /usr/local/lib/python3.7/dist-packages (from ipywidgets->nemo_toolkit[all]) (4.10.1)\n",
                "Requirement already satisfied: nbformat>=4.2.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets->nemo_toolkit[all]) (5.1.3)\n",
                "Requirement already satisfied: ipython>=4.0.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets->nemo_toolkit[all]) (5.5.0)\n",
                "Requirement already satisfied: jupyter-client in /usr/local/lib/python3.7/dist-packages (from ipykernel>=4.5.1->ipywidgets->nemo_toolkit[all]) (5.3.5)\n",
                "Requirement already satisfied: tornado>=4.0 in /usr/local/lib/python3.7/dist-packages (from ipykernel>=4.5.1->ipywidgets->nemo_toolkit[all]) (5.1.1)\n",
                "Requirement already satisfied: pickleshare in /usr/local/lib/python3.7/dist-packages (from ipython>=4.0.0->ipywidgets->nemo_toolkit[all]) (0.7.5)\n",
                "Requirement already satisfied: decorator in /usr/local/lib/python3.7/dist-packages (from ipython>=4.0.0->ipywidgets->nemo_toolkit[all]) (4.4.2)\n",
                "Requirement already satisfied: pygments in /usr/local/lib/python3.7/dist-packages (from ipython>=4.0.0->ipywidgets->nemo_toolkit[all]) (2.6.1)\n",
                "Requirement already satisfied: prompt-toolkit<2.0.0,>=1.0.4 in /usr/local/lib/python3.7/dist-packages (from ipython>=4.0.0->ipywidgets->nemo_toolkit[all]) (1.0.18)\n",
                "Requirement already satisfied: simplegeneric>0.8 in /usr/local/lib/python3.7/dist-packages (from ipython>=4.0.0->ipywidgets->nemo_toolkit[all]) (0.8.1)\n",
                "Requirement already satisfied: pexpect in /usr/local/lib/python3.7/dist-packages (from ipython>=4.0.0->ipywidgets->nemo_toolkit[all]) (4.8.0)\n",
                "Requirement already satisfied: jupyter-core in /usr/local/lib/python3.7/dist-packages (from nbformat>=4.2.0->ipywidgets->nemo_toolkit[all]) (4.9.1)\n",
                "Requirement already satisfied: jsonschema!=2.5.0,>=2.4 in /usr/local/lib/python3.7/dist-packages (from nbformat>=4.2.0->ipywidgets->nemo_toolkit[all]) (2.6.0)\n",
                "Requirement already satisfied: wcwidth in /usr/local/lib/python3.7/dist-packages (from prompt-toolkit<2.0.0,>=1.0.4->ipython>=4.0.0->ipywidgets->nemo_toolkit[all]) (0.2.5)\n",
                "Requirement already satisfied: notebook>=4.4.1 in /usr/local/lib/python3.7/dist-packages (from widgetsnbextension~=3.5.0->ipywidgets->nemo_toolkit[all]) (5.3.1)\n",
                "Requirement already satisfied: Send2Trash in /usr/local/lib/python3.7/dist-packages (from notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->nemo_toolkit[all]) (1.8.0)\n",
                "Requirement already satisfied: jinja2 in /usr/local/lib/python3.7/dist-packages (from notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->nemo_toolkit[all]) (2.11.3)\n",
                "Requirement already satisfied: terminado>=0.8.1 in /usr/local/lib/python3.7/dist-packages (from notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->nemo_toolkit[all]) (0.12.1)\n",
                "Requirement already satisfied: nbconvert in /usr/local/lib/python3.7/dist-packages (from notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->nemo_toolkit[all]) (5.6.1)\n",
                "Requirement already satisfied: pyzmq>=13 in /usr/local/lib/python3.7/dist-packages (from jupyter-client->ipykernel>=4.5.1->ipywidgets->nemo_toolkit[all]) (22.3.0)\n",
                "Requirement already satisfied: ptyprocess in /usr/local/lib/python3.7/dist-packages (from terminado>=0.8.1->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->nemo_toolkit[all]) (0.7.0)\n",
                "Requirement already satisfied: MarkupSafe>=0.23 in /usr/local/lib/python3.7/dist-packages (from jinja2->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->nemo_toolkit[all]) (2.0.1)\n",
                "Requirement already satisfied: audioread>=2.0.0 in /usr/local/lib/python3.7/dist-packages (from librosa->nemo_toolkit[all]) (2.1.9)\n",
                "Requirement already satisfied: pooch>=1.0 in /usr/local/lib/python3.7/dist-packages (from librosa->nemo_toolkit[all]) (1.5.2)\n",
                "Requirement already satisfied: resampy>=0.2.2 in /usr/local/lib/python3.7/dist-packages (from librosa->nemo_toolkit[all]) (0.2.2)\n",
                "Requirement already satisfied: llvmlite<0.35,>=0.34.0.dev0 in /usr/local/lib/python3.7/dist-packages (from numba->nemo_toolkit[all]) (0.34.0)\n",
                "Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.7/dist-packages (from scikit-learn->nemo_toolkit[all]) (3.0.0)\n",
                "Requirement already satisfied: cffi>=1.0 in /usr/local/lib/python3.7/dist-packages (from soundfile->nemo_toolkit[all]) (1.15.0)\n",
                "Requirement already satisfied: pycparser in /usr/local/lib/python3.7/dist-packages (from cffi>=1.0->soundfile->nemo_toolkit[all]) (2.21)\n",
                "Requirement already satisfied: entrypoints>=0.2.2 in /usr/local/lib/python3.7/dist-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->nemo_toolkit[all]) (0.3)\n",
                "Requirement already satisfied: testpath in /usr/local/lib/python3.7/dist-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->nemo_toolkit[all]) (0.5.0)\n",
                "Requirement already satisfied: bleach in /usr/local/lib/python3.7/dist-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->nemo_toolkit[all]) (4.1.0)\n",
                "Requirement already satisfied: pandocfilters>=1.4.1 in /usr/local/lib/python3.7/dist-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->nemo_toolkit[all]) (1.5.0)\n",
                "Requirement already satisfied: mistune<2,>=0.8.1 in /usr/local/lib/python3.7/dist-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->nemo_toolkit[all]) (0.8.4)\n",
                "Requirement already satisfied: defusedxml in /usr/local/lib/python3.7/dist-packages (from nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->nemo_toolkit[all]) (0.7.1)\n",
                "Requirement already satisfied: webencodings in /usr/local/lib/python3.7/dist-packages (from bleach->nbconvert->notebook>=4.4.1->widgetsnbextension~=3.5.0->ipywidgets->nemo_toolkit[all]) (0.5.1)\n",
                "Requirement already satisfied: pytz>=2017.2 in /usr/local/lib/python3.7/dist-packages (from pandas->nemo_toolkit[all]) (2018.9)\n",
                "Requirement already satisfied: pip in /usr/local/lib/python3.7/dist-packages (from pip-api->isort[requirements]<5->nemo_toolkit[all]) (21.1.3)\n",
                "Requirement already satisfied: docopt in /usr/local/lib/python3.7/dist-packages (from pipreqs->isort[requirements]<5->nemo_toolkit[all]) (0.6.2)\n",
                "Requirement already satisfied: yarg in /usr/local/lib/python3.7/dist-packages (from pipreqs->isort[requirements]<5->nemo_toolkit[all]) (0.1.9)\n",
                "Requirement already satisfied: simplejson>=3.8.1 in /usr/local/lib/python3.7/dist-packages (from pyannote.core->nemo_toolkit[all]) (3.17.6)\n",
                "Requirement already satisfied: sortedcontainers>=2.0.4 in /usr/local/lib/python3.7/dist-packages (from pyannote.core->nemo_toolkit[all]) (2.4.0)\n",
                "Requirement already satisfied: sympy>=1.1 in /usr/local/lib/python3.7/dist-packages (from pyannote.metrics->nemo_toolkit[all]) (1.7.1)\n",
                "Requirement already satisfied: pyannote.database>=4.0.1 in /usr/local/lib/python3.7/dist-packages (from pyannote.metrics->nemo_toolkit[all]) (4.1.1)\n",
                "Requirement already satisfied: tabulate>=0.7.7 in /usr/local/lib/python3.7/dist-packages (from pyannote.metrics->nemo_toolkit[all]) (0.8.9)\n",
                "Requirement already satisfied: typer[all]>=0.2.1 in /usr/local/lib/python3.7/dist-packages (from pyannote.database>=4.0.1->pyannote.metrics->nemo_toolkit[all]) (0.4.0)\n",
                "Requirement already satisfied: mpmath>=0.19 in /usr/local/lib/python3.7/dist-packages (from sympy>=1.1->pyannote.metrics->nemo_toolkit[all]) (1.2.1)\n",
                "Requirement already satisfied: shellingham<2.0.0,>=1.3.0 in /usr/local/lib/python3.7/dist-packages (from typer[all]>=0.2.1->pyannote.database>=4.0.1->pyannote.metrics->nemo_toolkit[all]) (1.4.0)\n",
                "Requirement already satisfied: colorama<0.5.0,>=0.4.3 in /usr/local/lib/python3.7/dist-packages (from typer[all]>=0.2.1->pyannote.database>=4.0.1->pyannote.metrics->nemo_toolkit[all]) (0.4.4)\n",
                "Requirement already satisfied: atomicwrites>=1.0 in /usr/local/lib/python3.7/dist-packages (from pytest->nemo_toolkit[all]) (1.4.0)\n",
                "Requirement already satisfied: pluggy<0.8,>=0.5 in /usr/local/lib/python3.7/dist-packages (from pytest->nemo_toolkit[all]) (0.7.1)\n",
                "Requirement already satisfied: more-itertools>=4.0.0 in /usr/local/lib/python3.7/dist-packages (from pytest->nemo_toolkit[all]) (8.12.0)\n",
                "Requirement already satisfied: py>=1.5.0 in /usr/local/lib/python3.7/dist-packages (from pytest->nemo_toolkit[all]) (1.11.0)\n",
                "Requirement already satisfied: ruamel.yaml.clib>=0.1.2 in /usr/local/lib/python3.7/dist-packages (from ruamel.yaml->nemo_toolkit[all]) (0.2.6)\n",
                "Requirement already satisfied: portalocker in /usr/local/lib/python3.7/dist-packages (from sacrebleu[ja]->nemo_toolkit[all]) (2.3.2)\n",
                "Requirement already satisfied: ipadic<2.0,>=1.0 in /usr/local/lib/python3.7/dist-packages (from sacrebleu[ja]->nemo_toolkit[all]) (1.0.0)\n",
                "Requirement already satisfied: mecab-python3==1.0.3 in /usr/local/lib/python3.7/dist-packages (from sacrebleu[ja]->nemo_toolkit[all]) (1.0.3)\n",
                "Requirement already satisfied: sphinxcontrib-jsmath in /usr/local/lib/python3.7/dist-packages (from sphinx->nemo_toolkit[all]) (1.0.1)\n",
                "Requirement already satisfied: snowballstemmer>=1.1 in /usr/local/lib/python3.7/dist-packages (from sphinx->nemo_toolkit[all]) (2.2.0)\n",
                "Requirement already satisfied: imagesize in /usr/local/lib/python3.7/dist-packages (from sphinx->nemo_toolkit[all]) (1.3.0)\n",
                "Requirement already satisfied: sphinxcontrib-devhelp in /usr/local/lib/python3.7/dist-packages (from sphinx->nemo_toolkit[all]) (1.0.2)\n",
                "Requirement already satisfied: sphinxcontrib-applehelp in /usr/local/lib/python3.7/dist-packages (from sphinx->nemo_toolkit[all]) (1.0.2)\n",
                "Requirement already satisfied: sphinxcontrib-htmlhelp>=2.0.0 in /usr/local/lib/python3.7/dist-packages (from sphinx->nemo_toolkit[all]) (2.0.0)\n",
                "Requirement already satisfied: sphinxcontrib-serializinghtml>=1.1.5 in /usr/local/lib/python3.7/dist-packages (from sphinx->nemo_toolkit[all]) (1.1.5)\n",
                "Requirement already satisfied: sphinxcontrib-qthelp in /usr/local/lib/python3.7/dist-packages (from sphinx->nemo_toolkit[all]) (1.0.3)\n",
                "Requirement already satisfied: docutils<0.18,>=0.14 in /usr/local/lib/python3.7/dist-packages (from sphinx->nemo_toolkit[all]) (0.17.1)\n",
                "Requirement already satisfied: alabaster<0.8,>=0.7 in /usr/local/lib/python3.7/dist-packages (from sphinx->nemo_toolkit[all]) (0.7.12)\n",
                "Requirement already satisfied: babel>=1.3 in /usr/local/lib/python3.7/dist-packages (from sphinx->nemo_toolkit[all]) (2.9.1)\n",
                "Requirement already satisfied: pybtex>=0.20 in /usr/local/lib/python3.7/dist-packages (from sphinxcontrib-bibtex->nemo_toolkit[all]) (0.24.0)\n",
                "Requirement already satisfied: pybtex-docutils>=1.0.0 in /usr/local/lib/python3.7/dist-packages (from sphinxcontrib-bibtex->nemo_toolkit[all]) (1.0.1)\n",
                "Requirement already satisfied: latexcodec>=1.0.4 in /usr/local/lib/python3.7/dist-packages (from pybtex>=0.20->sphinxcontrib-bibtex->nemo_toolkit[all]) (2.0.1)\n",
                "Requirement already satisfied: GitPython>=1.0.0 in /usr/local/lib/python3.7/dist-packages (from wandb->nemo_toolkit[all]) (3.1.24)\n",
                "Requirement already satisfied: pathtools in /usr/local/lib/python3.7/dist-packages (from wandb->nemo_toolkit[all]) (0.1.2)\n",
                "Requirement already satisfied: psutil>=5.0.0 in /usr/local/lib/python3.7/dist-packages (from wandb->nemo_toolkit[all]) (5.4.8)\n",
                "Requirement already satisfied: sentry-sdk>=1.0.0 in /usr/local/lib/python3.7/dist-packages (from wandb->nemo_toolkit[all]) (1.5.0)\n",
                "Requirement already satisfied: docker-pycreds>=0.4.0 in /usr/local/lib/python3.7/dist-packages (from wandb->nemo_toolkit[all]) (0.4.0)\n",
                "Requirement already satisfied: shortuuid>=0.5.0 in /usr/local/lib/python3.7/dist-packages (from wandb->nemo_toolkit[all]) (1.0.8)\n",
                "Requirement already satisfied: configparser>=3.8.1 in /usr/local/lib/python3.7/dist-packages (from wandb->nemo_toolkit[all]) (5.1.0)\n",
                "Requirement already satisfied: yaspin>=1.0.0 in /usr/local/lib/python3.7/dist-packages (from wandb->nemo_toolkit[all]) (2.1.0)\n",
                "Requirement already satisfied: promise<3,>=2.0 in /usr/local/lib/python3.7/dist-packages (from wandb->nemo_toolkit[all]) (2.3)\n",
                "Requirement already satisfied: subprocess32>=3.5.3 in /usr/local/lib/python3.7/dist-packages (from wandb->nemo_toolkit[all]) (3.5.4)\n",
                "Requirement already satisfied: gitdb<5,>=4.0.1 in /usr/local/lib/python3.7/dist-packages (from GitPython>=1.0.0->wandb->nemo_toolkit[all]) (4.0.9)\n",
                "Requirement already satisfied: smmap<6,>=3.0.1 in /usr/local/lib/python3.7/dist-packages (from gitdb<5,>=4.0.1->GitPython>=1.0.0->wandb->nemo_toolkit[all]) (5.0.0)\n",
                "Requirement already satisfied: termcolor<2.0.0,>=1.1.0 in /usr/local/lib/python3.7/dist-packages (from yaspin>=1.0.0->wandb->nemo_toolkit[all]) (1.1.0)\n",
                "Installing collected packages: matplotlib\n",
                "  Attempting uninstall: matplotlib\n",
                "    Found existing installation: matplotlib 3.1.3\n",
                "    Uninstalling matplotlib-3.1.3:\n",
                "      Successfully uninstalled matplotlib-3.1.3\n",
                "\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n",
                "albumentations 0.1.12 requires imgaug<0.2.7,>=0.2.5, but you have imgaug 0.2.9 which is incompatible.\u001b[0m\n",
                "Successfully installed matplotlib-3.5.0\n",
                "mkdir: cannot create directory ‘configs’: File exists\n",
                "--2021-11-30 19:50:39--  https://raw.githubusercontent.com/NVIDIA/NeMo/r1.4.0/examples/asr/conf/config.yaml\n",
                "Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.108.133, 185.199.109.133, 185.199.110.133, ...\n",
                "Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.108.133|:443... connected.\n",
                "HTTP request sent, awaiting response... 200 OK\n",
                "Length: 4040 (3.9K) [text/plain]\n",
                "Saving to: ‘configs/config.yaml.1’\n",
                "\n",
                "config.yaml.1       100%[===================>]   3.95K  --.-KB/s    in 0s      \n",
                "\n",
                "2021-11-30 19:50:39 (44.1 MB/s) - ‘configs/config.yaml.1’ saved [4040/4040]\n",
                "\n",
                "Collecting matplotlib==3.1.3\n",
                "  Using cached matplotlib-3.1.3-cp37-cp37m-manylinux1_x86_64.whl (13.1 MB)\n",
                "Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib==3.1.3) (0.11.0)\n",
                "Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib==3.1.3) (3.0.6)\n",
                "Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib==3.1.3) (1.3.2)\n",
                "Requirement already satisfied: numpy>=1.11 in /usr/local/lib/python3.7/dist-packages (from matplotlib==3.1.3) (1.19.5)\n",
                "Requirement already satisfied: python-dateutil>=2.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib==3.1.3) (2.8.2)\n",
                "Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil>=2.1->matplotlib==3.1.3) (1.15.0)\n",
                "Installing collected packages: matplotlib\n",
                "  Attempting uninstall: matplotlib\n",
                "    Found existing installation: matplotlib 3.5.0\n",
                "    Uninstalling matplotlib-3.5.0:\n",
                "      Successfully uninstalled matplotlib-3.5.0\n",
                "\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n",
                "albumentations 0.1.12 requires imgaug<0.2.7,>=0.2.5, but you have imgaug 0.2.9 which is incompatible.\u001b[0m\n",
                "Successfully installed matplotlib-3.1.3\n"
            ]
        },
        {
            "data": {
                "application/vnd.colab-display-data+json": {
                    "pip_warning": {
                        "packages": [
                            "matplotlib",
                            "mpl_toolkits"
                        ]
                    }
                }
            },
            "metadata": {},
            "output_type": "display_data"
        },
        {
            "data": {
                "application/vnd.google.colaboratory.intrinsic+json": {
                    "type": "string"
                },
                "text/plain": [
                    "'\\nRemember to restart the runtime for the kernel to pick up any upgraded packages (e.g. matplotlib)!\\nAlternatively, you can uncomment the exit() below to crash and restart the kernel, in the case\\nthat you want to use the \"Run All Cells\" (or similar) option.\\n'"
                ]
            },
            "execution_count": null,
            "metadata": {},
            "output_type": "execute_result"
        }
    ]
},
{
    "cell_type": "code",
    "metadata": {
        "colab": {
            "background_save": true
        },
        "id": "gAhsmi6HlRzh"
    },
    "source": [
        "# Папка, где будет размещаться датасет Golos\n",
        "data_dir = '/content'"
    ],
    "execution_count": null,
    "outputs": []
},
{
    "cell_type": "code",
    "metadata": {
        "colab": {
            "background_save": true
        },
        "id": "Yb4fuUvWlRzk",
        "scrolled": true,
        "outputId": "9c598e03-0385-40f0-87f9-336fce7a74e1"
    },
    "source": [
        "import glob\n",
        "import os\n",
        "import subprocess\n",
        "import tarfile\n",
        "import wget\n",
        "\n",
        "# Загрузка датасета Golos\n",
        "def load(golos_url, fname):\n",
        "  if not os.path.exists(os.path.join(data_dir, fname)):\n",
        "      golos_path = wget.download(golos_url, os.path.join(data_dir, fname))\n",
        "      print(f\"Dataset downloaded at: {golos_path}\")\n",
        "  else:\n",
        "      print(\"Tarfile already exists.\")\n",
        "      golos_path = os.path.join(data_dir, fname)\n",
        "  return golos_path\n",
        "\n",
        "golos_path = load(\"https://sc.link/Kqr\", \"test.tar\")\n",
        "\n",
        "if not os.path.exists(os.path.join(data_dir, '/test/')):\n",
        "    tar = tarfile.open(golos_path)\n",
        "    tar.extractall(path=data_dir)"
    ],
    "execution_count": null,
    "outputs": [
        {
            "name": "stdout",
            "output_type": "stream",
            "text": [
                "Tarfile already exists.\n"
            ]
        }
    ]
},
{
    "cell_type": "code",
    "metadata": {
        "colab": {
            "background_save": true
        },
        "id": "XY-VsVIvVMgc",
        "outputId": "39a86676-9bbc-433b-fdbe-15ee31c47acf"
    },
    "source": [
        "from google.colab import drive\n",
        "drive.mount('/content/drive', force_remount=True)"
    ],
    "execution_count": null,
    "outputs": [
        {
            "name": "stdout",
            "output_type": "stream",
            "text": [
                "Mounted at /content/drive\n"
            ]
        }
    ]
},
{
    "cell_type": "markdown",
    "metadata": {
        "id": "gfdk79JqEt3Q"
    },
},
{
    "cell_type": "markdown",
    "metadata": {
        "id": "m_LFeM0elRzm"
    },
    "source": [
        "Теперь в папке `/content` должна размещаться папка `test` с тестовыми данных датасета Golos. Она содержит файлы манифесты `./test/crowd/manifest.jsonl`, `./test/farfield/manifest.jsonl` и аудио файлы в подпапках `./test/crowd/files/` и `./test/farfield/files/`.\n",
        "\n",
        "Мы можем загрузить и посмотреть данные. Например файл `./test/crowd/files/e632f7d39c15e7edfc665b91e6f2071f.wav` это четырехсекундная запись мужчины, который произносит фразу `Купить моющее средство`. Чтобы убедиться в этом давайте послушаем запись:"
    ]
},
{
    "cell_type": "markdown",
    "metadata": {
        "id": "ABGFkUZhE48R"
    },
},
{
    "cell_type": "code",
    "metadata": {
        "id": "lTCLiCxcf9Mr"
    },
    "source": [
        "for file_info in farfield_data:\n",
        "  file_info['audio_filepath'] = '/content/drive/MyDrive/train_opus/' + file_info['audio_filepath']"
    ],
    "execution_count": null,
    "outputs": []
},
{
    "cell_type": "code",
    "metadata": {
        "id": "U50o_FQfgL-R"
    },
    "source": [
        "with open('/content/drive/MyDrive/универ/golos/farfield_train.json', \"w\", encoding='utf-8') as outfile:\n",
        "    for info in farfield_data:\n",
        "      json.dump(info, outfile, ensure_ascii=False)\n",
        "      outfile.write('\\n')"
    ],
    "execution_count": null,
    "outputs": []
},
{
    "cell_type": "code",
    "metadata": {
        "colab": {
            "base_uri": "https://localhost:8080/"
        },
        "id": "XC49hfDnLiGd",
        "outputId": "2e431773-bf4d-4f57-b937-ff390c1dbf63"
    },
    "source": [
        "!head /content/drive/MyDrive/универ/golos/farfield_train.json"
    ],
    "execution_count": null,
    "outputs": [
        {
            "name": "stdout",
            "output_type": "stream",
            "text": [
                "{\"id\": \"99a43331e70eda058820ba457f40dac1\", \"audio_filepath\": \"/content/drive/MyDrive/train_opus/farfield/99a43331e70eda058820ba457f40dac1.opus\", \"text\": \"салют лео и тик\", \"duration\": 2.8874375}\n",
                "{\"id\": \"eac60f97c53ef63d1a64f4973bb356bf\", \"audio_filepath\": \"/content/drive/MyDrive/train_opus/farfield/eac60f97c53ef63d1a64f4973bb356bf.opus\", \"text\": \"сбер в каком регионе находится лондонский метрополитен\", \"duration\": 6.2434375}\n",
                "{\"id\": \"992fd03a868431004a52eec5feb5dcec\", \"audio_filepath\": \"/content/drive/MyDrive/train_opus/farfield/992fd03a868431004a52eec5feb5dcec.opus\", \"text\": \"сбер\", \"duration\": 3.194875}\n",
                "{\"id\": \"1f250760d9dda6a7e7f0a195e42b50c5\", \"audio_filepath\": \"/content/drive/MyDrive/train_opus/farfield/1f250760d9dda6a7e7f0a195e42b50c5.opus\", \"text\": \"сбер сколько градусов будет в москве в двенадцать часов дня\", \"duration\": 4.1419375}\n",
                "{\"id\": \"518a94545125262bd397729016e90536\", \"audio_filepath\": \"/content/drive/MyDrive/train_opus/farfield/518a94545125262bd397729016e90536.opus\", \"text\": \"сбер в каких источниках описывается дезинсекция\", \"duration\": 5.630125}\n",
                "{\"id\": \"6884b1322ac8122e84f984df771412ee\", \"audio_filepath\": \"/content/drive/MyDrive/train_opus/farfield/6884b1322ac8122e84f984df771412ee.opus\", \"text\": \"афина химическая формула фуросемид\", \"duration\": 3.458125}\n",
                "{\"id\": \"0de10551f946453a9d018da179cd99ea\", \"audio_filepath\": \"/content/drive/MyDrive/train_opus/farfield/0de10551f946453a9d018da179cd99ea.opus\", \"text\": \"сегодня дождь\", \"duration\": 2.56125}\n",
                "{\"id\": \"49cb9a370b7f173a844ade5466d4b3f0\", \"audio_filepath\": \"/content/drive/MyDrive/train_opus/farfield/49cb9a370b7f173a844ade5466d4b3f0.opus\", \"text\": \"салют найти фильм комедию называется папе снова семнадцать\", \"duration\": 4.97}\n",
                "{\"id\": \"11c6aecd035716c96c745404a70611ee\", \"audio_filepath\": \"/content/drive/MyDrive/train_opus/farfield/11c6aecd035716c96c745404a70611ee.opus\", \"text\": \"салют пензенская область территориальный банк\", \"duration\": 4.063875}\n",
                "{\"id\": \"df85c3bd12e87386f762c2a50f11b2c0\", \"audio_filepath\": \"/content/drive/MyDrive/train_opus/farfield/df85c3bd12e87386f762c2a50f11b2c0.opus\", \"text\": \"джой что такое банкомат\", \"duration\": 2.300875}\n"
            ]
        }
    ]
},
{
    "cell_type": "markdown",
    "metadata": {
        "id": "cfCsjDnwFLjl"
    },
},
{
    "cell_type": "markdown",
    "metadata": {
        "id": "gEpNci7slRzw"
    },
    "source": [
        "# Использование NeMo для распонавания речи\n",
        "\n",
        "Теперь мы знаем что такое задача автоматичского распознавания речи и речевые данные, давайте использовать NeMo для распознавания речи.\n",
        "\n",
        "Мы будем использовать **Neural Modules (NeMo) toolkit**, поэтому нужно скачать и установить все ее зависимости. Для этого следуйте инструкции в репозитории [GitHub page](https://github.com/NVIDIA/NeMo), или документации [documentation](https://docs.nvidia.com/deeplearning/nemo/user-guide/docs/en/stable/).\n",
        "\n",
        "NeMo позволяет нам легко использовать все необходимые компоненты для нашей модели: dataloader,  промежуточные сверточные или рекурентные слои, разные loss  функции без необходимости разбираться в деталях реализации разных моедлей. В NeMo содержатся готовые реализованные модели в которых достаточно подать свои данные и задать гиперпараметры для обучения."
    ]
},
{
    "cell_type": "code",
    "metadata": {
        "colab": {
            "base_uri": "https://localhost:8080/",
            "height": 0
        },
        "id": "4_W0lhaQlRzx",
        "outputId": "6f76038a-55c6-4ed0-dc64-3d58e956573f"
    },
    "source": [
        "# NeMo's \"core\" package\n",
        "import nemo\n",
        "# NeMo's ASR collection - this collections contains complete ASR models and\n",
        "# building blocks (modules) for ASR\n",
        "import nemo.collections.asr as nemo_asr"
    ],
    "execution_count": 8,
    "outputs": [
        {
            "output_type": "stream",
            "name": "stderr",
            "text": [
                "[NeMo W 2021-11-30 19:52:37 optimizers:47] Apex was not found. Using the lamb optimizer will error out.\n",
                "################################################################################\n",
                "### WARNING, path does not exist: KALDI_ROOT=/mnt/matylda5/iveselyk/Tools/kaldi-trunk\n",
                "###          (please add 'export KALDI_ROOT=<your_path>' in your $HOME/.profile)\n",
                "###          (or run as: KALDI_ROOT=<your_path> python <your_script>.py)\n",
                "################################################################################\n",
                "\n",
                "[NeMo W 2021-11-30 19:52:38 experimental:28] Module <class 'nemo.collections.asr.data.audio_to_text_dali._AudioTextDALIDataset'> is experimental, not ready for production and is not fully supported. Use at your own risk.\n"
            ]
        }
    ]
},
{
    "cell_type": "markdown",
    "metadata": {
        "id": "v_W8EbYktZE3"
    },
    "source": [
        "## Исползование предобученной модели\n",
        "\n",
        "\n",
        "Коллекция для распознавания речи в NeMo содержит готовые блоки, которые можно использовать чтобы тренировать и использовать свою модель. Кроме этого существет ряд предобученных моделей, которые можно просто скачать и исползовать. Давайте скачаем и инициализируем готовую модель QuartzNet15x5, обученную на открытом датасете Golos.\n",
        "\n"
    ]
},
{
    "cell_type": "code",
    "metadata": {
        "id": "KFZZpYult96G"
    },
    "source": [
        "load(\"https://sc.link/ZMv\", \"QuartzNet15x5_golos.nemo\")\n",
        "\n",
        "asr_model = nemo_asr.models.EncDecCTCModel.restore_from(os.path.join(data_dir, \"QuartzNet15x5_golos.nemo\"))"
    ],
    "execution_count": null,
    "outputs": []
},
{
    "cell_type": "markdown",
    "metadata": {
        "id": "KucxoFJhum0i"
    },
    "source": [
        "Теперь указваем список фалов которые мы хотим транскрибировать и передаем в нашу модель. Это будет работать для относительно коротких аудио (<25 секунд) файлов. "
    ]
},
{
    "cell_type": "markdown",
    "metadata": {
        "id": "ABUDaC5Js7AW"
    },
    "source": [
        "## Обучение с нуля\n",
        "\n",
        "\n",
        "Для обучения нужно подготовить данные в нужном формате. Для этого добавим абсолютные пути к относительным в наших манифестах и используем их для обучения."
    ]
},
{
    "cell_type": "code",
    "metadata": {
        "colab": {
            "base_uri": "https://localhost:8080/",
            "height": 0
        },
        "id": "uWtStF94z46m",
        "outputId": "a5141bf2-16e1-4877-d6ba-10a692024e93"
    },
    "source": [
        "# --- Building Manifest Files --- #\n",
        "import json\n",
        "\n",
        "# Function to build a manifest\n",
        "def build_manifest(manifest_rel, manifest_abs):\n",
        "    manifest_path = os.path.split(os.path.abspath(manifest_rel))[0]\n",
        "    with open(manifest_rel, 'r') as fin:\n",
        "        with open(manifest_abs, 'w') as fout:\n",
        "            for line in fin:\n",
        "                metadata = json.loads(line)\n",
        "                metadata[\"audio_filepath\"]=os.path.join(manifest_path, metadata[\"audio_filepath\"])\n",
        "                json.dump(metadata, fout)\n",
        "                fout.write('\\n')\n",
        "                \n",
        "# Building Manifests\n",
        "print(\"******\")\n",
        "train_rel = os.path.join(data_dir, 'test/farfield/manifest.jsonl')\n",
        "train_abs = os.path.join(data_dir, 'test/farfield/farfield.jsonl')\n",
        "if not os.path.isfile(train_abs):\n",
        "  build_manifest(train_rel, train_abs)\n",
        "test_manifest = train_abs\n",
        "print(\"test_manifest\", test_manifest)\n",
        "\n",
        "train_rel = os.path.join(data_dir, 'test/crowd/manifest.jsonl')\n",
        "train_abs = os.path.join(data_dir, 'test/crowd/crowd.jsonl')\n",
        "if not os.path.isfile(train_abs):\n",
        "  build_manifest(train_rel, train_abs)\n",
        "train_manifest = train_abs\n",
        "print(\"train_manifest\", train_manifest)"
    ],
    "execution_count": 11,
    "outputs": [
        {
            "output_type": "stream",
            "name": "stdout",
            "text": [
                "******\n",
                "test_manifest /content/test/farfield/farfield.jsonl\n",
                "train_manifest /content/test/crowd/crowd.jsonl\n"
            ]
        }
    ]
},
{
    "cell_type": "markdown",
    "metadata": {
        "id": "aBvf45AJP_b3"
    },
    "source": [
        "Тут сделаем трюк. Как и было сказано выше, лучше модель работает  с короткими аудио. Возьмем только аудио короче 10 секунд, а также аудио, у которых есть транскрибция, а есть такие у которых ее нет)"
    ]
},
{
    "cell_type": "code",
    "metadata": {
        "id": "HeobXY1rRfCq"
    },
    "source": [
        "unused, used = 0, 0"
    ],
    "execution_count": 12,
    "outputs": []
},
{
    "cell_type": "code",
    "metadata": {
        "colab": {
            "base_uri": "https://localhost:8080/",
            "height": 0
        },
        "id": "rYgA9TB2NL57",
        "outputId": "e69a981c-d916-4fc3-ec4f-417b5f684951"
    },
    "source": [
        "with open('test/crowd/manifest.jsonl') as read_file:\n",
        "  data = [json.loads(jline) for jline in read_file.read().splitlines()]\n",
        "\n",
        "with open('test/crowd/manifest.json', 'w') as write_file:\n",
        "  for line in data:\n",
        "    if line[\"duration\"] < 10 and line['text']:\n",
        "      line['audio_filepath'] = '/content/test/crowd/' + line['audio_filepath'] \n",
        "      json.dump(line, write_file, ensure_ascii=False)\n",
        "      write_file.write('\\n')\n",
        "      used += 1\n",
        "    else:\n",
        "      unused += 1\n",
        "!head test/crowd/manifest.json"
    ],
    "execution_count": 13,
    "outputs": [
        {
            "output_type": "stream",
            "name": "stdout",
            "text": [
                "{\"id\": \"e632f7d39c15e7edfc665b91e6f2071f\", \"audio_filepath\": \"/content/test/crowd/files/e632f7d39c15e7edfc665b91e6f2071f.wav\", \"text\": \"афина воспроизведи музыку вперемешку\", \"duration\": 4.9}\n",
                "{\"id\": \"5db5df8bb9e3b6660b2a04b34d4a355d\", \"audio_filepath\": \"/content/test/crowd/files/5db5df8bb9e3b6660b2a04b34d4a355d.wav\", \"text\": \"найти сериал григорий р\", \"duration\": 3.652}\n",
                "{\"id\": \"2c471aedc6979109f28cd53c58f8c4fb\", \"audio_filepath\": \"/content/test/crowd/files/2c471aedc6979109f28cd53c58f8c4fb.wav\", \"text\": \"прямой эфир апл манчестер юнайтед тоттенхэм\", \"duration\": 4.34175}\n",
                "{\"id\": \"756a137ee9debde4a008adc4a4121dc7\", \"audio_filepath\": \"/content/test/crowd/files/756a137ee9debde4a008adc4a4121dc7.wav\", \"text\": \"ильвиром ивановичем ворончихиным\", \"duration\": 3.9}\n",
                "{\"id\": \"1ee3b00170123a6723a40e129b2f6bce\", \"audio_filepath\": \"/content/test/crowd/files/1ee3b00170123a6723a40e129b2f6bce.wav\", \"text\": \"можешь показать киношку исходный код\", \"duration\": 3.32}\n",
                "{\"id\": \"35e8b07c1109b98209aded328fa6da0e\", \"audio_filepath\": \"/content/test/crowd/files/35e8b07c1109b98209aded328fa6da0e.wav\", \"text\": \"изменился ли курс рубля к американскому доллару со вчерашнего дня\", \"duration\": 4.66}\n",
                "{\"id\": \"c35deaf94921ca67be23c19580a13397\", \"audio_filepath\": \"/content/test/crowd/files/c35deaf94921ca67be23c19580a13397.wav\", \"text\": \"найти фильм плохие парни первую часть\", \"duration\": 6.56}\n",
                "{\"id\": \"769fc2582dd82d1a3d4b7de9154d43b4\", \"audio_filepath\": \"/content/test/crowd/files/769fc2582dd82d1a3d4b7de9154d43b4.wav\", \"text\": \"эпизод тридцать один сезона тринадцать фильма люди\", \"duration\": 5.88}\n",
                "{\"id\": \"6a5c6ed155b43cdc77d2225084f6bd0a\", \"audio_filepath\": \"/content/test/crowd/files/6a5c6ed155b43cdc77d2225084f6bd0a.wav\", \"text\": \"купить моющее средство\", \"duration\": 5.1}\n",
                "{\"id\": \"38bf4f3c89e0507ee921a669fec12e9d\", \"audio_filepath\": \"/content/test/crowd/files/38bf4f3c89e0507ee921a669fec12e9d.wav\", \"text\": \"ноль триста восемь триста восемнадцать триста четыре шестьдесят девять\", \"duration\": 8.8231875}\n"
            ]
        }
    ]
},
{
    "cell_type": "code",
    "metadata": {
        "colab": {
            "base_uri": "https://localhost:8080/",
            "height": 0
        },
        "id": "KbIKWusDRyjG",
        "outputId": "99f0c235-2069-44af-8ac7-24b46b3060b2"
    },
    "source": [
        "print(f'used {used} and unused {unused}')"
    ],
    "execution_count": 14,
    "outputs": [
        {
            "output_type": "stream",
            "name": "stdout",
            "text": [
                "used 9878 and unused 116\n"
            ]
        }
    ]
},
{
    "cell_type": "markdown",
    "metadata": {
        "id": "BfJdMqeCRDkY"
    },
    "source": [
        "То же самое сделаем с farfield."
    ]
},
{
    "cell_type": "code",
    "metadata": {
        "id": "93hQN01GR7kf"
    },
    "source": [
        "unused, used = 0, 0"
    ],
    "execution_count": null,
    "outputs": []
},
{
    "cell_type": "code",
    "metadata": {
        "colab": {
            "base_uri": "https://localhost:8080/"
        },
        "id": "1oLYbs2jRHlC",
        "outputId": "94b5bcdd-15dc-4a5d-9af3-1ad2e36b7bc4"
    },
    "source": [
        "with open('/content/drive/MyDrive/универ/golos/farfield_train.json') as read_file:\n",
        "  data = [json.loads(jline) for jline in read_file.read().splitlines()]\n",
        "\n",
        "with open('/content/drive/MyDrive/универ/golos/farfield_train_clean.json', 'w') as write_file:\n",
        "  for line in data:\n",
        "    if line[\"duration\"] < 10 and line['text']:\n",
        "      json.dump(line, write_file, ensure_ascii=False)\n",
        "      write_file.write('\\n')\n",
        "      used += 1\n",
        "    else:\n",
        "      unused += 1\n",
        "!head /content/drive/MyDrive/универ/golos/farfield_train_clean.json"
    ],
    "execution_count": null,
    "outputs": [
        {
            "name": "stdout",
            "output_type": "stream",
            "text": [
                "{\"id\": \"99a43331e70eda058820ba457f40dac1\", \"audio_filepath\": \"/content/drive/MyDrive/train_opus/farfield/99a43331e70eda058820ba457f40dac1.opus\", \"text\": \"салют лео и тик\", \"duration\": 2.8874375}\n",
                "{\"id\": \"eac60f97c53ef63d1a64f4973bb356bf\", \"audio_filepath\": \"/content/drive/MyDrive/train_opus/farfield/eac60f97c53ef63d1a64f4973bb356bf.opus\", \"text\": \"сбер в каком регионе находится лондонский метрополитен\", \"duration\": 6.2434375}\n",
                "{\"id\": \"992fd03a868431004a52eec5feb5dcec\", \"audio_filepath\": \"/content/drive/MyDrive/train_opus/farfield/992fd03a868431004a52eec5feb5dcec.opus\", \"text\": \"сбер\", \"duration\": 3.194875}\n",
                "{\"id\": \"1f250760d9dda6a7e7f0a195e42b50c5\", \"audio_filepath\": \"/content/drive/MyDrive/train_opus/farfield/1f250760d9dda6a7e7f0a195e42b50c5.opus\", \"text\": \"сбер сколько градусов будет в москве в двенадцать часов дня\", \"duration\": 4.1419375}\n",
                "{\"id\": \"518a94545125262bd397729016e90536\", \"audio_filepath\": \"/content/drive/MyDrive/train_opus/farfield/518a94545125262bd397729016e90536.opus\", \"text\": \"сбер в каких источниках описывается дезинсекция\", \"duration\": 5.630125}\n",
                "{\"id\": \"6884b1322ac8122e84f984df771412ee\", \"audio_filepath\": \"/content/drive/MyDrive/train_opus/farfield/6884b1322ac8122e84f984df771412ee.opus\", \"text\": \"афина химическая формула фуросемид\", \"duration\": 3.458125}\n",
                "{\"id\": \"0de10551f946453a9d018da179cd99ea\", \"audio_filepath\": \"/content/drive/MyDrive/train_opus/farfield/0de10551f946453a9d018da179cd99ea.opus\", \"text\": \"сегодня дождь\", \"duration\": 2.56125}\n",
                "{\"id\": \"49cb9a370b7f173a844ade5466d4b3f0\", \"audio_filepath\": \"/content/drive/MyDrive/train_opus/farfield/49cb9a370b7f173a844ade5466d4b3f0.opus\", \"text\": \"салют найти фильм комедию называется папе снова семнадцать\", \"duration\": 4.97}\n",
                "{\"id\": \"11c6aecd035716c96c745404a70611ee\", \"audio_filepath\": \"/content/drive/MyDrive/train_opus/farfield/11c6aecd035716c96c745404a70611ee.opus\", \"text\": \"салют пензенская область территориальный банк\", \"duration\": 4.063875}\n",
                "{\"id\": \"df85c3bd12e87386f762c2a50f11b2c0\", \"audio_filepath\": \"/content/drive/MyDrive/train_opus/farfield/df85c3bd12e87386f762c2a50f11b2c0.opus\", \"text\": \"джой что такое банкомат\", \"duration\": 2.300875}\n"
            ]
        }
    ]
},
{
    "cell_type": "code",
    "metadata": {
        "colab": {
            "base_uri": "https://localhost:8080/"
        },
        "id": "_7QPMWBJRcCU",
        "outputId": "90b6f8b5-ff2d-48e5-c6d3-f207cf5c2524"
    },
    "source": [
        "print(f'used {used} and unused {unused}')"
    ],
    "execution_count": null,
    "outputs": [
        {
            "name": "stdout",
            "output_type": "stream",
            "text": [
                "used 115535 and unused 888\n"
            ]
        }
    ]
},
{
    "cell_type": "markdown",
    "metadata": {
        "id": "Aed3A-lSSEvr"
    },
    "source": [
        "Избавились почти от 1000 файлов в farfield, уже что-то. "
    ]
},
{
    "cell_type": "markdown",
    "metadata": {
        "id": "W2fShQzRzo-M"
    },
    "source": [
        "### Задаем модель при помощи YAML конфиг файла\n",
        "\n",
        "Для обучения мы создадим модель *Jasper_4x1*, в которой будет `K=4` блоков, один (`R=1`) под-блок и декодер *greedy CTC*, используя конфиг файл в `./configs/config.yaml`.\n",
        "\n",
        "\n",
        "Ниже приведен конфиг файл, давайте рассмотрим его и найдем части описанной архитектуры Jasper. Модель (model) содержит поле под названием `encoder` с под-полем `jasper` который состоит из списка полей. Каждое поле в списке задает конфигурацию блока в нашей моделе. Каждый блок выглядит примерно так:\n",
        "\n",
        "```\n",
        "- filters: 128\n",
        "  repeat: 1\n",
        "  kernel: [11]\n",
        "  stride: [2]\n",
        "  dilation: [1]\n",
        "  dropout: 0.2\n",
        "  residual: false\n",
        "  separable: true\n",
        "  se: true\n",
        "  se_context_size: -1\n",
        "```\n",
        "\n",
        "\n",
        "Первый элемент в спике соответствует первому блоку в Jasper архитектуре.\n",
        "\n",
        "Параметры обучающего и тестового датасета в полях (`train_ds`) и (`validation_ds`)\n",
        "\n",
        "Конфиг в формате YAML позволяем легко и в читаемой форме читать и модифицировать модель без необходимости менять код пррограммы."
    ]
},
{
    "cell_type": "code",
    "metadata": {
        "id": "lVB1sG1GlRzz"
    },
    "source": [
        "! cat ./configs/config.yaml"
    ],
    "execution_count": null,
    "outputs": []
},
{
    "cell_type": "code",
    "metadata": {
        "colab": {
            "base_uri": "https://localhost:8080/",
            "height": 0
        },
        "id": "PXVKBniMlRz5",
        "outputId": "b61e98f0-1af5-402c-d7b2-c5057da2cdf1"
    },
    "source": [
        "# --- Config Information ---#\n",
        "try:\n",
        "    from ruamel.yaml import YAML\n",
        "except ModuleNotFoundError:\n",
        "    from ruamel_yaml import YAML\n",
        "config_path = './configs/config.yaml'\n",
        "\n",
        "yaml = YAML(typ='safe')\n",
        "with open(config_path) as f:\n",
        "    params = yaml.load(f)\n",
        "    \n",
        "print(params)"
    ],
    "execution_count": 16,
    "outputs": [
        {
            "output_type": "stream",
            "name": "stdout",
            "text": [
                "{'name': 'QuartzNet15x5', 'sample_rate': 16000, 'repeat': 1, 'dropout': 0.0, 'separable': True, 'labels': [' ', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', \"'\"], 'model': {'train_ds': {'manifest_filepath': '???', 'sample_rate': 16000, 'labels': [' ', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', \"'\"], 'batch_size': 32, 'trim_silence': True, 'max_duration': 16.7, 'shuffle': True, 'is_tarred': False, 'tarred_audio_filepaths': None, 'tarred_shard_strategy': 'scatter'}, 'validation_ds': {'manifest_filepath': '???', 'sample_rate': 16000, 'labels': [' ', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', \"'\"], 'batch_size': 32, 'shuffle': False}, 'preprocessor': {'_target_': 'nemo.collections.asr.modules.AudioToMelSpectrogramPreprocessor', 'normalize': 'per_feature', 'window_size': 0.02, 'sample_rate': 16000, 'window_stride': 0.01, 'window': 'hann', 'features': 64, 'n_fft': 512, 'frame_splicing': 1, 'dither': 1e-05, 'stft_conv': False}, 'spec_augment': {'_target_': 'nemo.collections.asr.modules.SpectrogramAugmentation', 'rect_freq': 50, 'rect_masks': 5, 'rect_time': 120}, 'encoder': {'_target_': 'nemo.collections.asr.modules.ConvASREncoder', 'feat_in': 64, 'activation': 'relu', 'conv_mask': True, 'jasper': [{'filters': 128, 'repeat': 1, 'kernel': [11], 'stride': [1], 'dilation': [1], 'dropout': 0.0, 'residual': True, 'separable': True, 'se': True, 'se_context_size': -1}, {'filters': 256, 'repeat': 1, 'kernel': [13], 'stride': [1], 'dilation': [1], 'dropout': 0.0, 'residual': True, 'separable': True, 'se': True, 'se_context_size': -1}, {'filters': 256, 'repeat': 1, 'kernel': [15], 'stride': [1], 'dilation': [1], 'dropout': 0.0, 'residual': True, 'separable': True, 'se': True, 'se_context_size': -1}, {'filters': 256, 'repeat': 1, 'kernel': [17], 'stride': [1], 'dilation': [1], 'dropout': 0.0, 'residual': True, 'separable': True, 'se': True, 'se_context_size': -1}, {'filters': 256, 'repeat': 1, 'kernel': [19], 'stride': [1], 'dilation': [1], 'dropout': 0.0, 'residual': True, 'separable': True, 'se': True, 'se_context_size': -1}, {'filters': 256, 'repeat': 1, 'kernel': [21], 'stride': [1], 'dilation': [1], 'dropout': 0.0, 'residual': False, 'separable': True, 'se': True, 'se_context_size': -1}, {'filters': 1024, 'repeat': 1, 'kernel': [1], 'stride': [1], 'dilation': [1], 'dropout': 0.0, 'residual': False, 'separable': True, 'se': True, 'se_context_size': -1}]}, 'decoder': {'_target_': 'nemo.collections.asr.modules.ConvASRDecoder', 'feat_in': 1024, 'num_classes': 28, 'vocabulary': [' ', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', \"'\"]}, 'optim': {'name': 'novograd', 'lr': 0.01, 'betas': [0.8, 0.5], 'weight_decay': 0.001, 'sched': {'name': 'CosineAnnealing', 'monitor': 'val_loss', 'reduce_on_plateau': False, 'warmup_steps': None, 'warmup_ratio': None, 'min_lr': 0.0, 'last_epoch': -1}}}, 'trainer': {'gpus': 0, 'max_epochs': 5, 'max_steps': None, 'num_nodes': 1, 'accelerator': 'ddp', 'accumulate_grad_batches': 1, 'checkpoint_callback': False, 'logger': False, 'log_every_n_steps': 1, 'val_check_interval': 1.0}, 'exp_manager': {'exp_dir': None, 'name': 'QuartzNet15x5', 'create_tensorboard_logger': True, 'create_checkpoint_callback': True}, 'hydra': {'run': {'dir': '.'}, 'job_logging': {'root': {'handlers': None}}}}\n"
            ]
        }
    ]
},
{
    "cell_type": "code",
    "metadata": {
        "colab": {
            "base_uri": "https://localhost:8080/",
            "height": 0
        },
        "id": "9sLV9_JVub-0",
        "outputId": "c2bde0dd-4a25-4134-c8a4-87fadf973453"
    },
    "source": [
        "# Use Russian vocabulary \n",
        "print(asr_model.decoder.vocabulary)\n",
        "params[\"labels\"] = asr_model.decoder.vocabulary\n",
        "params[\"model\"][\"train_ds\"][\"labels\"] = asr_model.decoder.vocabulary\n",
        "params[\"model\"][\"validation_ds\"][\"labels\"] = asr_model.decoder.vocabulary\n",
        "params[\"model\"][\"decoder\"][\"vocabulary\"] = asr_model.decoder.vocabulary\n",
        "params[\"model\"][\"decoder\"][\"num_classes\"] = len(asr_model.decoder.vocabulary)\n",
        "print(params)"
    ],
    "execution_count": 17,
    "outputs": [
        {
            "output_type": "stream",
            "name": "stdout",
            "text": [
                "[' ', 'а', 'б', 'в', 'г', 'д', 'е', 'ж', 'з', 'и', 'й', 'к', 'л', 'м', 'н', 'о', 'п', 'р', 'с', 'т', 'у', 'ф', 'х', 'ц', 'ч', 'ш', 'щ', 'ъ', 'ы', 'ь', 'э', 'ю', 'я']\n",
                "{'name': 'QuartzNet15x5', 'sample_rate': 16000, 'repeat': 1, 'dropout': 0.0, 'separable': True, 'labels': [' ', 'а', 'б', 'в', 'г', 'д', 'е', 'ж', 'з', 'и', 'й', 'к', 'л', 'м', 'н', 'о', 'п', 'р', 'с', 'т', 'у', 'ф', 'х', 'ц', 'ч', 'ш', 'щ', 'ъ', 'ы', 'ь', 'э', 'ю', 'я'], 'model': {'train_ds': {'manifest_filepath': '???', 'sample_rate': 16000, 'labels': [' ', 'а', 'б', 'в', 'г', 'д', 'е', 'ж', 'з', 'и', 'й', 'к', 'л', 'м', 'н', 'о', 'п', 'р', 'с', 'т', 'у', 'ф', 'х', 'ц', 'ч', 'ш', 'щ', 'ъ', 'ы', 'ь', 'э', 'ю', 'я'], 'batch_size': 32, 'trim_silence': True, 'max_duration': 16.7, 'shuffle': True, 'is_tarred': False, 'tarred_audio_filepaths': None, 'tarred_shard_strategy': 'scatter'}, 'validation_ds': {'manifest_filepath': '???', 'sample_rate': 16000, 'labels': [' ', 'а', 'б', 'в', 'г', 'д', 'е', 'ж', 'з', 'и', 'й', 'к', 'л', 'м', 'н', 'о', 'п', 'р', 'с', 'т', 'у', 'ф', 'х', 'ц', 'ч', 'ш', 'щ', 'ъ', 'ы', 'ь', 'э', 'ю', 'я'], 'batch_size': 32, 'shuffle': False}, 'preprocessor': {'_target_': 'nemo.collections.asr.modules.AudioToMelSpectrogramPreprocessor', 'normalize': 'per_feature', 'window_size': 0.02, 'sample_rate': 16000, 'window_stride': 0.01, 'window': 'hann', 'features': 64, 'n_fft': 512, 'frame_splicing': 1, 'dither': 1e-05, 'stft_conv': False}, 'spec_augment': {'_target_': 'nemo.collections.asr.modules.SpectrogramAugmentation', 'rect_freq': 50, 'rect_masks': 5, 'rect_time': 120}, 'encoder': {'_target_': 'nemo.collections.asr.modules.ConvASREncoder', 'feat_in': 64, 'activation': 'relu', 'conv_mask': True, 'jasper': [{'filters': 128, 'repeat': 1, 'kernel': [11], 'stride': [1], 'dilation': [1], 'dropout': 0.0, 'residual': True, 'separable': True, 'se': True, 'se_context_size': -1}, {'filters': 256, 'repeat': 1, 'kernel': [13], 'stride': [1], 'dilation': [1], 'dropout': 0.0, 'residual': True, 'separable': True, 'se': True, 'se_context_size': -1}, {'filters': 256, 'repeat': 1, 'kernel': [15], 'stride': [1], 'dilation': [1], 'dropout': 0.0, 'residual': True, 'separable': True, 'se': True, 'se_context_size': -1}, {'filters': 256, 'repeat': 1, 'kernel': [17], 'stride': [1], 'dilation': [1], 'dropout': 0.0, 'residual': True, 'separable': True, 'se': True, 'se_context_size': -1}, {'filters': 256, 'repeat': 1, 'kernel': [19], 'stride': [1], 'dilation': [1], 'dropout': 0.0, 'residual': True, 'separable': True, 'se': True, 'se_context_size': -1}, {'filters': 256, 'repeat': 1, 'kernel': [21], 'stride': [1], 'dilation': [1], 'dropout': 0.0, 'residual': False, 'separable': True, 'se': True, 'se_context_size': -1}, {'filters': 1024, 'repeat': 1, 'kernel': [1], 'stride': [1], 'dilation': [1], 'dropout': 0.0, 'residual': False, 'separable': True, 'se': True, 'se_context_size': -1}]}, 'decoder': {'_target_': 'nemo.collections.asr.modules.ConvASRDecoder', 'feat_in': 1024, 'num_classes': 33, 'vocabulary': [' ', 'а', 'б', 'в', 'г', 'д', 'е', 'ж', 'з', 'и', 'й', 'к', 'л', 'м', 'н', 'о', 'п', 'р', 'с', 'т', 'у', 'ф', 'х', 'ц', 'ч', 'ш', 'щ', 'ъ', 'ы', 'ь', 'э', 'ю', 'я']}, 'optim': {'name': 'novograd', 'lr': 0.01, 'betas': [0.8, 0.5], 'weight_decay': 0.001, 'sched': {'name': 'CosineAnnealing', 'monitor': 'val_loss', 'reduce_on_plateau': False, 'warmup_steps': None, 'warmup_ratio': None, 'min_lr': 0.0, 'last_epoch': -1}}}, 'trainer': {'gpus': 0, 'max_epochs': 5, 'max_steps': None, 'num_nodes': 1, 'accelerator': 'ddp', 'accumulate_grad_batches': 1, 'checkpoint_callback': False, 'logger': False, 'log_every_n_steps': 1, 'val_check_interval': 1.0}, 'exp_manager': {'exp_dir': None, 'name': 'QuartzNet15x5', 'create_tensorboard_logger': True, 'create_checkpoint_callback': True}, 'hydra': {'run': {'dir': '.'}, 'job_logging': {'root': {'handlers': None}}}}\n"
            ]
        }
    ]
},
{
    "cell_type": "code",
    "metadata": {
        "id": "Ll7OImYKa4Li"
    },
    "source": [
        "import numpy as np"
    ],
    "execution_count": 18,
    "outputs": []
},
{
    "cell_type": "code",
    "metadata": {
        "id": "BcmSOZBQwnSf"
    },
    "source": [
        "params['trainer']['max_epochs'] = 10\n",
        "params['model']['optim']['lr'] = 5*np.e - 5"
    ],
    "execution_count": 19,
    "outputs": []
},
{
    "cell_type": "markdown",
    "metadata": {
        "id": "wUmq3p2Aw_5N"
    },
    "source": [
        "### Использование PyTorch Lightning\n",
        "\n",
        "NeMo модели и модули могуть исползоваться в любом PyTorch проекте где ожидается тип torch.nn.Module.\n",
        "\n",
        "Однако, NeMo модели созданы на основе [PytorchLightning's](https://github.com/PyTorchLightning/pytorch-lightning) LightningModule, поэтому рекомендуется использовать PytorchLightning для обучения и дообучения (fine-tuning) так как это позволяет легко применять mixed precision и распределенное обучение. Давайте создадим объект Trainer для обучения на GPU 5 эпох."
    ]
},
{
    "cell_type": "code",
    "metadata": {
        "colab": {
            "base_uri": "https://localhost:8080/",
            "height": 0
        },
        "id": "GUfR6tAK0k2u",
        "outputId": "d07c32fc-e4a0-4d98-9834-4ba0bce10218"
    },
    "source": [
        "import pytorch_lightning as pl\n",
        "trainer = pl.Trainer(gpus=1, max_epochs=5)"
    ],
    "execution_count": 20,
    "outputs": [
        {
            "output_type": "stream",
            "name": "stderr",
            "text": [
                "GPU available: True, used: True\n",
                "TPU available: False, using: 0 TPU cores\n",
                "IPU available: False, using: 0 IPUs\n"
            ]
        }
    ]
},
{
    "cell_type": "markdown",
    "metadata": {
        "id": "ISYke1mnHcwx"
    },
    "source": [
        "Зададим дополнительно batch size. "
    ]
},
{
    "cell_type": "code",
    "metadata": {
        "id": "0s2fQTfjSlGQ"
    },
    "source": [
        "train_manifest = 'test/crowd/manifest.json'"
    ],
    "execution_count": 21,
    "outputs": []
},
{
    "cell_type": "code",
    "metadata": {
        "colab": {
            "base_uri": "https://localhost:8080/",
            "height": 0
        },
        "id": "Cbf0fsMK09lk",
        "outputId": "6b45a496-1380-4cab-8200-bf666e8dd224"
    },
    "source": [
        "from omegaconf import DictConfig\n",
        "params['model']['train_ds']['manifest_filepath'] = train_manifest\n",
        "params['model']['validation_ds']['manifest_filepath'] = test_manifest\n",
        "params['model']['train_ds']['batch_size'] = 64\n",
        "params['model']['validation_ds']['batch_size'] = 64\n",
        "first_asr_model = nemo_asr.models.EncDecCTCModel(cfg=DictConfig(params['model']), trainer=trainer)"
    ],
    "execution_count": 37,
    "outputs": [
        {
            "output_type": "stream",
            "name": "stdout",
            "text": [
                "[NeMo I 2021-11-30 20:13:52 audio_to_text_dataset:37] Model level config does not container `sample_rate`, please explicitly provide `sample_rate` to the dataloaders.\n",
                "[NeMo I 2021-11-30 20:13:52 audio_to_text_dataset:37] Model level config does not container `labels`, please explicitly provide `labels` to the dataloaders.\n",
                "[NeMo I 2021-11-30 20:13:52 collections:173] Dataset loaded with 9878 files totalling 10.79 hours\n",
                "[NeMo I 2021-11-30 20:13:52 collections:174] 0 files were filtered totalling 0.00 hours\n",
                "[NeMo I 2021-11-30 20:13:52 audio_to_text_dataset:37] Model level config does not container `sample_rate`, please explicitly provide `sample_rate` to the dataloaders.\n",
                "[NeMo I 2021-11-30 20:13:52 audio_to_text_dataset:37] Model level config does not container `labels`, please explicitly provide `labels` to the dataloaders.\n",
                "[NeMo I 2021-11-30 20:13:52 collections:173] Dataset loaded with 1916 files totalling 1.41 hours\n",
                "[NeMo I 2021-11-30 20:13:52 collections:174] 0 files were filtered totalling 0.00 hours\n",
                "[NeMo I 2021-11-30 20:13:52 features:262] PADDING: 16\n",
                "[NeMo I 2021-11-30 20:13:52 features:279] STFT using torch\n"
            ]
        }
    ]
},
{
    "cell_type": "code",
    "metadata": {
        "colab": {
            "base_uri": "https://localhost:8080/",
            "height": 1405,
            "referenced_widgets": [
                "84ab5c2121b64d8cbae57e2273b01e67",
                "d5f45845091c4710a90d357e8e5f548e",
                "a7adb739ca1e49e483b09d53959c6f64",
                "f026cdd1eee947c2bf39882bcd97ac41",
                "645d5189cd9c4951a645d5e851777b72",
                "63ea41fc3372498f80d45c93bd585465",
                "60392cf58b88485ebcd00cdfa6d81efb",
                "66ed539d7a8146eea926f2a58b585450",
                "428011d8dbca46ffb283bd8853154d58",
                "9e04ab4cfb6543d980b36e85fb43d56c",
                "57c34e976a0649cd883fece02509d97a",
                "314d9097b51346eb82769412691f80ca",
                "33bf93d58a2d4f1a9bad924e61762b59",
                "05c4ab35cae64f99a20effc2c2056624",
                "c7f80c5802f3430c827a737ca3dcdead",
                "5b8fafcc2b6e48148d1365c43f56c0e9",
                "299a8120286544969b7b36b91933f524",
                "bc161a7d8b4b435cbc72436e921abc40",
                "2586b3014de845488a69a5758b3353d1",
                "dd43e6765f8840e5be3f5999e73dc4c1",
                "9d7e7281a9d548a59d14301cca068725",
                "aecfd4db10b447cbabc9015a3069b82c",
                "596884913ace448a8825462061813a4f",
                "fd6df388a9f04bbaa0c3217fad285655",
                "41a880413d4d4e57abea967ec4c1a692",
                "e6ccc13c896b4cb887e1cf2965e91304",
                "9a5d38c31f0d4207bdef5b70abc5ec2c",
                "94c3e870f71547de855564315dd3b68f",
                "ac73492261af44198992834d18a8f6f4",
                "d14acf4cbde346fc911955146a8eff8d",
                "2f9cd95f3d7a48869c523e4b8428ded6",
                "174a9cac73db478cbe21d4c323886d01",
                "f588c5b3bb4643308c32864a0d9ac63d",
                "494499b103ba4acd981142e881e98bab",
                "df4925395daa4b19b2b1594da0c1359d",
                "811547e792e443578cc1c2aa7543e55e",
                "25c4dca83e284e0ea863665ee91cd1cc",
                "f9fdbed2720548eb9711f8f9ccb1e2f3",
                "481a9172e1f64a20b2ba30abd7756d99",
                "cff634a919e848c8b1e0b6aca4794aa4",
                "424f31585196492e95b54da3288efaa0",
                "7103c799acfc42649bb9185c023cc799",
                "396648494f8d4748a5006ef94c889136",
                "2cb7743efe39499ba38d9462de6ffcea",
                "3d546d31a9ec4b569da2913c1eff2027",
                "658a73053b4d4f0e9d91489b2273ff0d",
                "4937e82555fa48a39ab909e5aec2c073",
                "f1212314108a423391c56778fe1faf1f",
                "36a59e521c664a37998d30ddd08ba212",
                "bc4643481ba3449091dbb5bc6b5570bf",
                "5a845a89ba3644719af7339edec5055f",
                "8fced5fb01ef45c8b4142ca47cc288c9",
                "71ab2d40a4b44a6e9dab85e729a32adc",
                "6604a003a1194881950be17362179d67",
                "a4b5b8b0d8cd475aa736217131bce1f3",
                "40dbcfe887d143b0983be8e98d21d078",
                "9d09d0dd4f26439982f29ab28e797b1f",
                "ee9ab678e78b4be6bd4bcbfb905fe0b6",
                "465396f3c72d4ae1a23b8b38cfe701c1",
                "c6ffbd06c66e40ca98bea00609a4a4f6",
                "5292fad7438b4ef2a075eb4f4ed77a99",
                "0f4a1cda107548f1828b628ec7f2b922",
                "47f4bd0be1394133aa71116310daab10",
                "7fef4bdb898d4062990b2ec28c316ef7",
                "b9ac3c1cfa6e4a50a73d876ac358fa6f",
                "b9e8e905427549d0a87840f1152320fe",
                "2461834afe024e6c803aa059316f5ad8",
                "b3a6dfef4a544ed9be045214ef83bf9b",
                "3bb0df660e4449f0a46259f0c762a016",
                "21532804ac5649feaf799496f7eebf9d",
                "648f9c1b82d6419fae79c4d7c7da8628",
                "237c45ffd5e24b348deeef6a5560e23a",
                "9e2ebd4437d948aab355a2f25c76cd10",
                "ff93a095a9c844029b850a8d98bddc32",
                "a10a8f4b68b34f5b8d35df7a2f01e829",
                "c5d5cb673601482f9fdcf55c1d73cfd2",
                "bba47da6d2e24ff8b2d58db0f38aee7c"
            ]
        },
        "id": "EPwkOWv9epuM",
        "outputId": "bdde8586-847b-41c7-9b06-d50512630840"
    },
    "source": [
        "# Use the smaller learning rate we set before\n",
        "first_asr_model.setup_optimization(optim_config=DictConfig(new_opt))\n",
        "\n",
        "# Point to the data we'll use for fine-tuning as the training set\n",
        "first_asr_model.setup_training_data(train_data_config=params['model']['train_ds'])\n",
        "\n",
        "# Point to the new validation data for fine-tuning\n",
        "first_asr_model.setup_validation_data(val_data_config=params['model']['validation_ds'])\n",
        "\n",
        "# And now we can create a PyTorch Lightning trainer and call `fit` again.\n",
        "trainer = pl.Trainer(gpus=1, max_epochs=5)\n",
        "trainer.fit(first_asr_model)"
    ],
    "execution_count": 38,
    "outputs": [
        {
            "output_type": "stream",
            "name": "stdout",
            "text": [
                "[NeMo I 2021-11-30 20:14:03 modelPT:544] Optimizer config = Novograd (\n",
                "    Parameter Group 0\n",
                "        amsgrad: False\n",
                "        betas: [0.8, 0.5]\n",
                "        eps: 1e-08\n",
                "        grad_averaging: False\n",
                "        lr: 5e-05\n",
                "        weight_decay: 0.001\n",
                "    )\n",
                "[NeMo I 2021-11-30 20:14:03 lr_scheduler:625] Scheduler \"<nemo.core.optim.lr_scheduler.CosineAnnealing object at 0x7fad4f85f410>\" \n",
                "    will be used during training (effective maximum steps = 775) - \n",
                "    Parameters : \n",
                "    (warmup_steps: null\n",
                "    warmup_ratio: null\n",
                "    min_lr: 0.0\n",
                "    last_epoch: -1\n",
                "    max_steps: 775\n",
                "    )\n",
                "[NeMo I 2021-11-30 20:14:03 audio_to_text_dataset:37] Model level config does not container `sample_rate`, please explicitly provide `sample_rate` to the dataloaders.\n",
                "[NeMo I 2021-11-30 20:14:03 audio_to_text_dataset:37] Model level config does not container `labels`, please explicitly provide `labels` to the dataloaders.\n",
                "[NeMo I 2021-11-30 20:14:04 collections:173] Dataset loaded with 9878 files totalling 10.79 hours\n",
                "[NeMo I 2021-11-30 20:14:04 collections:174] 0 files were filtered totalling 0.00 hours\n",
                "[NeMo I 2021-11-30 20:14:04 audio_to_text_dataset:37] Model level config does not container `sample_rate`, please explicitly provide `sample_rate` to the dataloaders.\n",
                "[NeMo I 2021-11-30 20:14:04 audio_to_text_dataset:37] Model level config does not container `labels`, please explicitly provide `labels` to the dataloaders.\n",
                "[NeMo I 2021-11-30 20:14:04 collections:173] Dataset loaded with 1916 files totalling 1.41 hours\n",
                "[NeMo I 2021-11-30 20:14:04 collections:174] 0 files were filtered totalling 0.00 hours\n"
            ]
        },
        {
            "output_type": "stream",
            "name": "stderr",
            "text": [
                "GPU available: True, used: True\n",
                "TPU available: False, using: 0 TPU cores\n",
                "IPU available: False, using: 0 IPUs\n",
                "LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]\n"
            ]
        },
        {
            "output_type": "stream",
            "name": "stdout",
            "text": [
                "[NeMo I 2021-11-30 20:14:04 modelPT:544] Optimizer config = Novograd (\n",
                "    Parameter Group 0\n",
                "        amsgrad: False\n",
                "        betas: [0.8, 0.5]\n",
                "        eps: 1e-08\n",
                "        grad_averaging: False\n",
                "        lr: 5e-05\n",
                "        weight_decay: 0.001\n",
                "    )\n",
                "[NeMo I 2021-11-30 20:14:04 lr_scheduler:625] Scheduler \"<nemo.core.optim.lr_scheduler.CosineAnnealing object at 0x7fad493eb4d0>\" \n",
                "    will be used during training (effective maximum steps = 775) - \n",
                "    Parameters : \n",
                "    (warmup_steps: null\n",
                "    warmup_ratio: null\n",
                "    min_lr: 0.0\n",
                "    last_epoch: -1\n",
                "    max_steps: 775\n",
                "    )\n"
            ]
        },
        {
            "output_type": "stream",
            "name": "stderr",
            "text": [
                "\n",
                "  | Name              | Type                              | Params\n",
                "------------------------------------------------------------------------\n",
                "0 | preprocessor      | AudioToMelSpectrogramPreprocessor | 0     \n",
                "1 | encoder           | ConvASREncoder                    | 1.2 M \n",
                "2 | decoder           | ConvASRDecoder                    | 34.9 K\n",
                "3 | loss              | CTCLoss                           | 0     \n",
                "4 | spec_augmentation | SpectrogramAugmentation           | 0     \n",
                "5 | _wer              | WER                               | 0     \n",
                "------------------------------------------------------------------------\n",
                "1.2 M     Trainable params\n",
                "0         Non-trainable params\n",
                "1.2 M     Total params\n",
                "4.856     Total estimated model params size (MB)\n"
            ]
        },
        {
            "output_type": "display_data",
            "data": {
                "application/vnd.jupyter.widget-view+json": {
                    "model_id": "84ab5c2121b64d8cbae57e2273b01e67",
                    "version_minor": 0,
                    "version_major": 2
                },
                "text/plain": [
                    "Validation sanity check: 0it [00:00, ?it/s]"
                ]
            },
            "metadata": {}
        },
        {
            "output_type": "stream",
            "name": "stderr",
            "text": [
                "[NeMo W 2021-11-30 20:14:04 nemo_logging:349] /usr/local/lib/python3.7/dist-packages/pytorch_lightning/trainer/data_loading.py:106: UserWarning: The dataloader, val dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 4 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.\n",
                "      f\"The dataloader, {name}, does not have many workers which may be a bottleneck.\"\n",
                "    \n",
                "[NeMo W 2021-11-30 20:14:04 nemo_logging:349] /usr/local/lib/python3.7/dist-packages/pytorch_lightning/trainer/data_loading.py:106: UserWarning: The dataloader, train dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 4 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.\n",
                "      f\"The dataloader, {name}, does not have many workers which may be a bottleneck.\"\n",
                "    \n"
            ]
        },
        {
            "output_type": "display_data",
            "data": {
                "application/vnd.jupyter.widget-view+json": {
                    "model_id": "314d9097b51346eb82769412691f80ca",
                    "version_minor": 0,
                    "version_major": 2
                },
                "text/plain": [
                    "Training: -1it [00:00, ?it/s]"
                ]
            },
            "metadata": {}
        },
        {
            "output_type": "display_data",
            "data": {
                "application/vnd.jupyter.widget-view+json": {
                    "model_id": "596884913ace448a8825462061813a4f",
                    "version_minor": 0,
                    "version_major": 2
                },
                "text/plain": [
                    "Validating: 0it [00:00, ?it/s]"
                ]
            },
            "metadata": {}
        },
        {
            "output_type": "display_data",
            "data": {
                "application/vnd.jupyter.widget-view+json": {
                    "model_id": "494499b103ba4acd981142e881e98bab",
                    "version_minor": 0,
                    "version_major": 2
                },
                "text/plain": [
                    "Validating: 0it [00:00, ?it/s]"
                ]
            },
            "metadata": {}
        },
        {
            "output_type": "display_data",
            "data": {
                "application/vnd.jupyter.widget-view+json": {
                    "model_id": "3d546d31a9ec4b569da2913c1eff2027",
                    "version_minor": 0,
                    "version_major": 2
                },
                "text/plain": [
                    "Validating: 0it [00:00, ?it/s]"
                ]
            },
            "metadata": {}
        },
        {
            "output_type": "display_data",
            "data": {
                "application/vnd.jupyter.widget-view+json": {
                    "model_id": "40dbcfe887d143b0983be8e98d21d078",
                    "version_minor": 0,
                    "version_major": 2
                },
                "text/plain": [
                    "Validating: 0it [00:00, ?it/s]"
                ]
            },
            "metadata": {}
        },
        {
            "output_type": "display_data",
            "data": {
                "application/vnd.jupyter.widget-view+json": {
                    "model_id": "2461834afe024e6c803aa059316f5ad8",
                    "version_minor": 0,
                    "version_major": 2
                },
                "text/plain": [
                    "Validating: 0it [00:00, ?it/s]"
                ]
            },
            "metadata": {}
        }
    ]
},
{
    "cell_type": "markdown",
    "metadata": {
        "id": "hWtzwL5qXTYq"
    },
    "source": [
        "Мы можем начать обучение всего одной строчкой!"
    ]
},
{
    "cell_type": "markdown",
    "metadata": {
        "id": "sGZzRCvIW8kE"
    },
    "source": [
        "Let's say we wanted to change the learning rate. To do so, we can create a `new_opt` dict and set our desired learning rate, then call `<model>.setup_optimization()` with the new optimization parameters."
    ]
},
{
    "cell_type": "code",
    "metadata": {
        "id": "AbigFKUtYgvn"
    },
    "source": [
        "import copy\n",
        "new_opt = copy.deepcopy(params['model']['optim'])\n",
        "new_opt['lr'] = 5e-5\n",
        "first_asr_model.setup_optimization(optim_config=DictConfig(new_opt))\n",
        "trainer.fit(first_asr_model)"
    ],
    "execution_count": null,
    "outputs": []
},
{
    "cell_type": "markdown",
    "metadata": {
        "id": "D5Kwg8Cz-aaO"
    },
    "source": [
        "## Inference\n",
        "\n",
        "Let's have a quick look at how one could run inference with NeMo's ASR model.\n",
        "\n",
        "First, ``EncDecCTCModel`` and its subclasses contain a handy ``transcribe`` method which can be used to simply obtain audio files' transcriptions. It also has batch_size argument to improve performance."
    ]
},
{
    "cell_type": "markdown",
    "metadata": {
        "id": "6FiCfLX0D7py"
    },
    "source": [
        "Below is an example of a simple inference loop in pure PyTorch. It also shows how one can compute Word Error Rate (WER) metric between predictions and references."
    ]
},
{
    "cell_type": "code",
    "metadata": {
        "id": "21O91yNoXa4p"
    },
    "source": [
        "import torch"
    ],
    "execution_count": null,
    "outputs": []
},
{
    "cell_type": "code",
    "metadata": {
        "colab": {
            "base_uri": "https://localhost:8080/"
        },
        "id": "4SOxM1haW-Hy",
        "outputId": "2b9ae0f8-48cf-4259-ef5b-8c104d88fcac"
    },
    "source": [
        "device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n",
        "print(device)"
    ],
    "execution_count": null,
    "outputs": [
        {
            "name": "stdout",
            "output_type": "stream",
            "text": [
                "cuda\n"
            ]
        }
    ]
},
{
    "cell_type": "code",
    "metadata": {
        "colab": {
            "base_uri": "https://localhost:8080/",
            "height": 0
        },
        "id": "7mP4r1Gx_Ilt",
        "outputId": "442d0be3-5c64-4a0e-8d81-fa16edfa346d"
    },
    "source": [
        "# Bigger batch-size = bigger throughput\n",
        "params['model']['validation_ds']['batch_size'] = 64\n",
        "\n",
        "# Setup the test data loader and make sure the model is on GPU\n",
        "first_asr_model.setup_test_data(test_data_config=params['model']['validation_ds'])\n",
        "first_asr_model.cuda()\n",
        "\n",
        "\n",
        "wer_nums = []\n",
        "wer_denoms = []\n",
        "\n",
        "audio_lengths = []\n",
        "audio_signals_low_wer = []\n",
        "bad_examples = []\n",
        "\n",
        "# Loop over all test batches.\n",
        "# Iterating over the model's `test_dataloader` will give us:\n",
        "# (audio_signal, audio_signal_length, transcript_tokens, transcript_length)\n",
        "# See the AudioToCharDataset for more details.\n",
        "for test_batch in asr_model.test_dataloader():\n",
        "        test_batch = [x.cuda() for x in test_batch]\n",
        "\n",
        "        audio_length = test_batch[1] # it will be used to choose short ones \n",
        "        audio_lengths.extend(audio_length.float())\n",
        "\n",
        "        targets = test_batch[2]\n",
        "        targets_lengths = test_batch[3]        \n",
        "        log_probs, encoded_len, greedy_predictions = first_asr_model(\n",
        "            input_signal=test_batch[0].cpu(), input_signal_length=test_batch[1].cpu()\n",
        "        )\n",
        "        # Notice the model has a helper object to compute WER\n",
        "        asr_model._wer.update(greedy_predictions, targets, targets_lengths)\n",
        "        _, wer_num, wer_denom = asr_model._wer.compute()\n",
        "        wer = wer_num / wer_denom\n",
        "        if wer >= 0.8:\n",
        "          bad_examples.append(test_batch)\n",
        "        asr_model._wer.reset()\n",
        "        wer_nums.append(wer_num.detach().cpu().numpy())\n",
        "        wer_denoms.append(wer_denom.detach().cpu().numpy())\n",
        "\n",
        "        # Release tensors from GPU memory\n",
        "        del test_batch, log_probs, targets, targets_lengths, encoded_len, greedy_predictions\n",
        "\n",
        "# We need to sum all numerators and denominators first. Then divide.\n",
        "print(f\"WER = {sum(wer_nums)/sum(wer_denoms)}\")"
    ],
    "execution_count": 39,
    "outputs": [
        {
            "output_type": "stream",
            "name": "stdout",
            "text": [
                "[NeMo I 2021-11-30 20:19:35 collections:173] Dataset loaded with 1916 files totalling 1.41 hours\n",
                "[NeMo I 2021-11-30 20:19:35 collections:174] 0 files were filtered totalling 0.00 hours\n",
                "WER = 1.0\n"
            ]
        }
    ]
},
{
    "cell_type": "code",
    "metadata": {
        "colab": {
            "base_uri": "https://localhost:8080/",
            "height": 36
        },
        "id": "9WZynMm4_1on",
        "outputId": "939d7180-8373-488c-b0f9-91019f5a592b"
    },
    "source": [
        "audio_lengths = torch.stack(audio_lengths)\n",
        "f'in all test data max length {torch.max(audio_lengths)}, min {torch.min(audio_lengths)}, mean {torch.mean(audio_lengths)}'"
    ],
    "execution_count": null,
    "outputs": [
        {
            "data": {
                "application/vnd.google.colaboratory.intrinsic+json": {
                    "type": "string"
                },
                "text/plain": [
                    "'in all test data max length 197434.0, min 1600.0, mean 42327.68359375'"
                ]
            },
            "execution_count": 72,
            "metadata": {},
            "output_type": "execute_result"
        }
    ]
},
{
    "cell_type": "code",
    "metadata": {
        "colab": {
            "base_uri": "https://localhost:8080/",
            "height": 36
        },
        "id": "Nl_hrJIK7wQU",
        "outputId": "616af379-00be-4ca9-ab17-80c1866ef213"
    },
    "source": [
        "f\"there are {len(bad_examples)} bad examples and in percentage it is {len(bad_examples) /  len(asr_model.test_dataloader()) * 100} % of the whole test data\" "
    ],
    "execution_count": null,
    "outputs": [
        {
            "data": {
                "application/vnd.google.colaboratory.intrinsic+json": {
                    "type": "string"
                },
                "text/plain": [
                    "'there are 48 bad examples and in percentage it is 40.0 % of the whole test data'"
                ]
            },
            "execution_count": 73,
            "metadata": {},
            "output_type": "execute_result"
        }
    ]
},
{
    "cell_type": "code",
    "metadata": {
        "id": "fm5E3UZK-u3e"
    },
    "source": [
        "import torch"
    ],
    "execution_count": null,
    "outputs": []
},
{
    "cell_type": "code",
    "metadata": {
        "colab": {
            "base_uri": "https://localhost:8080/",
            "height": 36
        },
        "id": "1Bb2aNm_7JN8",
        "outputId": "4e902812-7f1c-4514-f3bd-f031700a1484"
    },
    "source": [
        "audio_lengths_bad = torch.cat([batch[1].float() for batch in bad_examples], 0)\n",
        "f'in all bad examples {torch.max(audio_lengths_bad)} , min {torch.min(audio_lengths_bad)}, mean {torch.mean(audio_lengths_bad)}'"
    ],
    "execution_count": null,
    "outputs": [
        {
            "data": {
                "application/vnd.google.colaboratory.intrinsic+json": {
                    "type": "string"
                },
                "text/plain": [
                    "'in all bad examples 151992.0 , min 14867.0, mean 38432.8828125'"
                ]
            },
            "execution_count": 77,
            "metadata": {},
            "output_type": "execute_result"
        }
    ]
},
{
    "cell_type": "markdown",
    "metadata": {
        "id": "0kM9kBNOCptf"
    },
    "source": [
        "This WER is not particularly impressive and could be significantly improved. You could train longer (try 100 epochs) to get a better number. Check out the next section on how to improve it further."
    ]
},
{
    "cell_type": "markdown",
    "metadata": {
        "id": "LdwdcA_a640R"
    },
    "source": [
        "If you want to enable SpecAugment in your model, make sure your .yaml config file contains 'model/spec_augment' section which looks like the one above."
    ]
},
{
    "cell_type": "markdown",
    "metadata": {
        "id": "M7lvmiMSd3Aw"
    },
    "source": [
        "After this, our decoder has completely changed, but our encoder (which is where most of the weights are) remained intact. Let's fine tune-this model for 2 epochs on AN4 dataset. We will also use the smaller learning rate from ``new_opt`` (see the \"After Training\" section)`."
    ]
},
{
    "cell_type": "code",
    "metadata": {
        "colab": {
            "base_uri": "https://localhost:8080/",
            "height": 1000,
            "referenced_widgets": [
                "e076fc0bc6e746059a01556e33843003",
                "0ba43df3639f4b2081227fe499caf3ea",
                "4ff367afa2394d7ea2ffb1fda885f987",
                "e5ce9f7388564dc58a30079220b19bb2"
            ]
        },
        "id": "_PZJIso-eDl-",
        "outputId": "70a5833c-3cde-4ad1-ef1b-b7a8095d9972"
    },
    "source": [
        "# Use the smaller learning rate we set before\n",
        "first_asr_model.setup_optimization(optim_config=DictConfig(new_opt))\n",
        "\n",
        "# Point to the data we'll use for fine-tuning as the training set\n",
        "first_asr_model.setup_training_data(train_data_config=params['model']['train_ds'])\n",
        "\n",
        "# Point to the new validation data for fine-tuning\n",
        "first_asr_model.setup_validation_data(val_data_config=params['model']['validation_ds'])\n",
        "\n",
        "# And now we can create a PyTorch Lightning trainer and call `fit` again.\n",
        "trainer = pl.Trainer(gpus=1, max_epochs=2)\n",
        "trainer.fit(first_asr_model)"
    ],
    "execution_count": null,
    "outputs": [
        {
            "name": "stdout",
            "output_type": "stream",
            "text": [
                "[NeMo I 2021-10-11 17:42:55 modelPT:544] Optimizer config = Novograd (\n",
                "    Parameter Group 0\n",
                "        amsgrad: False\n",
                "        betas: [0.8, 0.5]\n",
                "        eps: 1e-08\n",
                "        grad_averaging: False\n",
                "        lr: 0.001\n",
                "        weight_decay: 0.001\n",
                "    )\n",
                "[NeMo I 2021-10-11 17:42:55 lr_scheduler:625] Scheduler \"<nemo.core.optim.lr_scheduler.CosineAnnealing object at 0x7fccf617e710>\" \n",
                "    will be used during training (effective maximum steps = 626) - \n",
                "    Parameters : \n",
                "    (warmup_steps: null\n",
                "    warmup_ratio: null\n",
                "    min_lr: 0.0\n",
                "    last_epoch: -1\n",
                "    max_steps: 626\n",
                "    )\n",
                "[NeMo I 2021-10-11 17:42:55 audio_to_text_dataset:37] Model level config does not container `sample_rate`, please explicitly provide `sample_rate` to the dataloaders.\n",
                "[NeMo I 2021-10-11 17:42:55 audio_to_text_dataset:37] Model level config does not container `labels`, please explicitly provide `labels` to the dataloaders.\n",
                "[NeMo I 2021-10-11 17:42:55 collections:173] Dataset loaded with 948 files totalling 0.71 hours\n",
                "[NeMo I 2021-10-11 17:42:55 collections:174] 0 files were filtered totalling 0.00 hours\n",
                "[NeMo I 2021-10-11 17:42:55 audio_to_text_dataset:37] Model level config does not container `sample_rate`, please explicitly provide `sample_rate` to the dataloaders.\n",
                "[NeMo I 2021-10-11 17:42:55 audio_to_text_dataset:37] Model level config does not container `labels`, please explicitly provide `labels` to the dataloaders.\n",
                "[NeMo I 2021-10-11 17:42:55 collections:173] Dataset loaded with 130 files totalling 0.10 hours\n",
                "[NeMo I 2021-10-11 17:42:55 collections:174] 0 files were filtered totalling 0.00 hours\n"
            ]
        },
        {
            "name": "stderr",
            "output_type": "stream",
            "text": [
                "GPU available: True, used: True\n",
                "TPU available: False, using: 0 TPU cores\n",
                "IPU available: False, using: 0 IPUs\n",
                "LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]\n"
            ]
        },
        {
            "name": "stdout",
            "output_type": "stream",
            "text": [
                "[NeMo I 2021-10-11 17:42:55 modelPT:544] Optimizer config = Novograd (\n",
                "    Parameter Group 0\n",
                "        amsgrad: False\n",
                "        betas: [0.8, 0.5]\n",
                "        eps: 1e-08\n",
                "        grad_averaging: False\n",
                "        lr: 0.001\n",
                "        weight_decay: 0.001\n",
                "    )\n",
                "[NeMo I 2021-10-11 17:42:55 lr_scheduler:625] Scheduler \"<nemo.core.optim.lr_scheduler.CosineAnnealing object at 0x7fccfd5a35d0>\" \n",
                "    will be used during training (effective maximum steps = 60) - \n",
                "    Parameters : \n",
                "    (warmup_steps: null\n",
                "    warmup_ratio: null\n",
                "    min_lr: 0.0\n",
                "    last_epoch: -1\n",
                "    max_steps: 60\n",
                "    )\n"
            ]
        },
        {
            "name": "stderr",
            "output_type": "stream",
            "text": [
                "\n",
                "  | Name              | Type                              | Params\n",
                "------------------------------------------------------------------------\n",
                "0 | preprocessor      | AudioToMelSpectrogramPreprocessor | 0     \n",
                "1 | encoder           | ConvASREncoder                    | 1.2 M \n",
                "2 | spec_augmentation | SpectrogramAugmentation           | 0     \n",
                "3 | _wer              | WER                               | 0     \n",
                "4 | decoder           | ConvASRDecoder                    | 30.8 K\n",
                "5 | loss              | CTCLoss                           | 0     \n",
                "------------------------------------------------------------------------\n",
                "1.2 M     Trainable params\n",
                "0         Non-trainable params\n",
                "1.2 M     Total params\n",
                "4.840     Total estimated model params size (MB)\n"
            ]
        },
        {
            "data": {
                "application/vnd.jupyter.widget-view+json": {
                    "model_id": "e076fc0bc6e746059a01556e33843003",
                    "version_major": 2,
                    "version_minor": 0
                },
                "text/plain": [
                    "Validation sanity check: 0it [00:00, ?it/s]"
                ]
            },
            "metadata": {},
            "output_type": "display_data"
        },
        {
            "name": "stderr",
            "output_type": "stream",
            "text": [
                "[NeMo W 2021-10-11 17:42:56 nemo_logging:349] /usr/local/lib/python3.7/dist-packages/pytorch_lightning/trainer/data_loading.py:327: UserWarning: The number of training samples (30) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.\n",
                "      f\"The number of training samples ({self.num_training_batches}) is smaller than the logging interval\"\n",
                "    \n"
            ]
        },
        {
            "data": {
                "application/vnd.jupyter.widget-view+json": {
                    "model_id": "0ba43df3639f4b2081227fe499caf3ea",
                    "version_major": 2,
                    "version_minor": 0
                },
                "text/plain": [
                    "Training: -1it [00:00, ?it/s]"
                ]
            },
            "metadata": {},
            "output_type": "display_data"
        },
        {
            "data": {
                "application/vnd.jupyter.widget-view+json": {
                    "model_id": "4ff367afa2394d7ea2ffb1fda885f987",
                    "version_major": 2,
                    "version_minor": 0
                },
                "text/plain": [
                    "Validating: 0it [00:00, ?it/s]"
                ]
            },
            "metadata": {},
            "output_type": "display_data"
        },
        {
            "data": {
                "application/vnd.jupyter.widget-view+json": {
                    "model_id": "e5ce9f7388564dc58a30079220b19bb2",
                    "version_major": 2,
                    "version_minor": 0
                },
                "text/plain": [
                    "Validating: 0it [00:00, ?it/s]"
                ]
            },
            "metadata": {},
            "output_type": "display_data"
        }
    ]
},
{
    "cell_type": "markdown",
    "metadata": {
        "id": "jtVhMAcqdRtX"
    },
    "source": [
        "Увы, ресурсов не хватило для лучшего обучения. \n",
        "\n",
        "wer = 1.0"
    ]
}
]
}